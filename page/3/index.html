<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

</head>

</html>

<body>
  <div id="app">
    
      
      <canvas width="1777" height="841"
        style="position: fixed; left: 0px; top: 0px; z-index: 99999; pointer-events: none;"></canvas>
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/bg.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Doreen&#39;s Blog</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['hello world', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-react01"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/04/10/react01/"
    >【react】开发环境搭建</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/04/10/react01/" class="article-date">
  <time datetime="2020-04-10T04:21:42.000Z" itemprop="datePublished">2020-04-10</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/react/">react</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="首先安装-Node-和-npm"><a href="#首先安装-Node-和-npm" class="headerlink" title="首先安装 Node 和 npm"></a>首先安装 Node 和 npm</h2><p>我的版本 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node v10.15</span><br><span class="line">npm v6.4.1</span><br></pre></td></tr></table></figure>
<h2 id="创建应用程序"><a href="#创建应用程序" class="headerlink" title="创建应用程序"></a>创建应用程序</h2><ol>
<li>针对于npm 5.2+<blockquote>
<p>npx create-react-app xxx</p>
</blockquote>
</li>
<li>针对于npm 6+<blockquote>
<p>npm init react-app xxx</p>
</blockquote>
</li>
<li>针对于yarn 0.25+<blockquote>
<p>yarn create react-app xxx</p>
</blockquote>
</li>
</ol>
<h2 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h2><p>进入到xxx目录中，应该生成的目录格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">xxx</span><br><span class="line">├── README.md</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── .gitignore</span><br><span class="line">├── public</span><br><span class="line">│   ├── favicon.ico</span><br><span class="line">│   ├── index.html</span><br><span class="line">│   └── manifest.json</span><br><span class="line">└── src</span><br><span class="line">    ├── App.css</span><br><span class="line">    ├── App.js</span><br><span class="line">    ├── App.test.js</span><br><span class="line">    ├── index.css</span><br><span class="line">    ├── index.js</span><br><span class="line">    ├── logo.svg</span><br><span class="line">    └── serviceWorker.js</span><br></pre></td></tr></table></figure>
<p>安装完成后，即可进入到项目目录：</p>
<blockquote>
<p>cd xxx</p>
</blockquote>
<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><ol>
<li>运行：<blockquote>
<p>npm start</p>
</blockquote>
</li>
<li>打包：<blockquote>
<p>npm run build</p>
</blockquote>
</li>
</ol>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>按照文档的方式安装运行脚手架工具报错,并且生成的文件缺失<br>报错信息如下：</p>
<blockquote>
<p>A template was not provided. This is likely because you’re using an outdated version of create-react-app.<br>Please note that global installs of create-react-app are no longer supported.  </p>
</blockquote>
<p>（大概意思是 官方不支持 create-react-app 这个 cli 脚手架，版本已经过时，不支持全局安装）<br>因为我之前也有看过react的相关视频 可能安装的有之前的脚手架版本</p>
<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>卸载全局安装的脚手架</p>
<blockquote>
<p>npm uninstall -g create-react-app<br>然后在重新按照之前的步骤在运行一次</p>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-ES2020新特性"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/04/09/ES2020%E6%96%B0%E7%89%B9%E6%80%A7/"
    >ES2020新特性</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/04/09/ES2020%E6%96%B0%E7%89%B9%E6%80%A7/" class="article-date">
  <time datetime="2020-04-09T04:21:42.000Z" itemprop="datePublished">2020-04-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <blockquote>
<p>不是所有的都会记录 只记录一些我目前能理解的和我觉得比较有用的</p>
</blockquote>
<h2 id="类的私有变量和方法"><a href="#类的私有变量和方法" class="headerlink" title="类的私有变量和方法"></a>类的私有变量和方法</h2><blockquote>
<p>通过 # 代表私有变量和方法，在class外部无法访问 （相当于private）</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Num</span></span>&#123;</span><br><span class="line">    #privateNum = 0     //私有变量</span><br><span class="line">    static #privateStaticNum = 0        //静态私有变量</span><br><span class="line">    add()&#123;</span><br><span class="line">        this.#privateNum++</span><br><span class="line">        Num.#privateStaticNum++</span><br><span class="line">    &#125;</span><br><span class="line">    print()&#123;</span><br><span class="line">        console.log(this.#privateNum,Num.#privateStaticNum)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Num()</span><br><span class="line">a.add()</span><br><span class="line">a.print()   <span class="comment">// 1 1</span></span><br><span class="line">console.log(a.#privateNum)     // SyntaxError</span><br><span class="line">console.log(Num.#privateStaticNum)       // SyntaxError</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在MDN和其他的一些大佬的总结里面也写了可以定义私有方法</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">  类似于以这种形式</span></span><br><span class="line"><span class="comment">  不知道是什么原因会报错 unexpected token</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Method</span>()</span>&#123;</span><br><span class="line">    #privateStaticMethod()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    publicStaticMethod()&#123;</span><br><span class="line">        return #privateStaticMethod()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">       另外看到有人总结是用这种形式</span></span><br><span class="line"><span class="comment">       可以正常运行 但是我感觉这种形式就是私有变量的定义赋给一个函数而已？</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    #privateStaticMethod = ()=&gt;&#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="空值合并运算符（Nullish-coalescing-Operator）"><a href="#空值合并运算符（Nullish-coalescing-Operator）" class="headerlink" title="空值合并运算符（Nullish coalescing Operator）"></a>空值合并运算符（Nullish coalescing Operator）</h2><blockquote>
<p>和 || 的作用类似，但是 || 会将空字符串、0、false等直接覆盖，可能会造成一些问题，<br>?? 运算符只针对 null、undefined 进行覆盖</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> b = <span class="string">&#x27;&#x27;</span> || <span class="number">123</span>     <span class="comment">// 123</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="string">&#x27;&#x27;</span> ?? <span class="number">123</span>     <span class="comment">// &#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="可选链（Optional-chaining）"><a href="#可选链（Optional-chaining）" class="headerlink" title="可选链（Optional chaining）"></a>可选链（Optional chaining）</h2><blockquote>
<p>简化繁琐重复的前置校验操作</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">    info: &#123;</span><br><span class="line">        name: &#123;</span><br><span class="line">            getName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;doreen&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> names = user &amp;&amp; user.info &amp;&amp; user.info.name &amp;&amp; user.info.name.getName &amp;&amp;  user.info.name.getName()</span><br><span class="line"><span class="keyword">let</span> name = user?.info?.name?.getName?.()    <span class="comment">// =&gt;  user?.info?.name?.getName()</span></span><br></pre></td></tr></table></figure>
<h2 id="dynamic-import"><a href="#dynamic-import" class="headerlink" title="dynamic-import"></a>dynamic-import</h2><blockquote>
<p>之前的按需引入是静态import、目前更新的是动态的import()  </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用法区别：static import没有括号，dynamic import() 带有括号</span></span><br><span class="line"><span class="comment">// static import : 有声明提升、一般放在头部位置</span></span><br><span class="line"><span class="keyword">import</span> name <span class="keyword">from</span> <span class="string">&#x27;url&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// dynamic import : 放在任意位置</span></span><br><span class="line"><span class="keyword">const</span> name = <span class="keyword">import</span>(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> test.js:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">export &#123;xxx&#125;    引入的时候 import &#123;xxx&#125; from &#x27;xxx&#x27; 可以有多个</span></span><br><span class="line"><span class="comment">export default function()&#123;...&#125;  / export default &#123; a()&#123;...&#125;,b()&#123;...&#125; &#125;  </span></span><br><span class="line"><span class="comment">引入的时候 import xxx from &#x27;xxx&#x27;  只能写一次</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">n,m</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n+m</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; add &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// a.js:</span></span><br><span class="line"><span class="comment">// import()相当于一个promise的实例对象</span></span><br><span class="line"><span class="keyword">const</span> doAdd = <span class="keyword">async</span> (n,m)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> foo = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;./test.js&#x27;</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(foo.add(n,m))</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">const</span> doAdd = <span class="function">(<span class="params">n,m</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">import</span>(<span class="string">&#x27;./test.js&#x27;</span>).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res.add(n,m))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">doAdd(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="globalThis"><a href="#globalThis" class="headerlink" title="globalThis"></a>globalThis</h2><blockquote>
<p>提供了一个标准的方式去获取不同环境下的全局对象(gloabl、window)<br>在web下能正常打印，但是在node下还是不能正常输出？</p>
</blockquote>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/duyujian706709149/article/details/104014127">https://blog.csdn.net/duyujian706709149/article/details/104014127</a><br><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000022006869">https://segmentfault.com/a/1190000022006869</a><br><a target="_blank" rel="noopener" href="https://www.jb51.net/article/178289.htm">https://www.jb51.net/article/178289.htm</a><br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Classes/Class_elements">MDN</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-table"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/02/27/table/"
    >JavaScript实现文本编辑器 【table相关操作】</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/02/27/table/" class="article-date">
  <time datetime="2020-02-27T02:16:00.000Z" itemprop="datePublished">2020-02-27</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <pre>
  我自己写的基本操作可以实现
  就是table结构改变了之后 在操作会出现一些问题
  目前没想通要怎么处理 
  查了下看到一个大佬用jQuery写的合并拆分
  基本把我的一些bug解决了 但是我没有看懂他的逻辑QAQ
</pre>
<h2 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h2><blockquote>
<p>table的底部和侧边有一个  +  号标记可以添加行/列</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;delTable()&quot;</span>&gt;</span>delete<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;addCell()&quot;</span>&gt;</span>addCell<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;addRow()&quot;</span>&gt;</span>addRow<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;mergeTable()&quot;</span>&gt;</span>合并单元格<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;mergeDown()&quot;</span>&gt;</span>向下合并单元格<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;mergeRight()&quot;</span>&gt;</span>向右合并单元格<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;splitTable()&quot;</span>&gt;</span>拆分单元格<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;table&quot;</span>  <span class="attr">contentEditable</span>=<span class="string">&#x27;true&#x27;</span> &gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">id</span>=<span class="string">&quot;table&quot;</span>&gt;</span></span><br><span class="line">				...</span><br><span class="line">			<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;addCell&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;addCell()&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;addRow&#x27;</span> <span class="attr">onclick</span>=<span class="string">&quot;addRow()&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="删除功能"><a href="#删除功能" class="headerlink" title="删除功能"></a>删除功能</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  delTable: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">this</span>.table.remove() <span class="comment">//dom自带方法</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="添加列功能"><a href="#添加列功能" class="headerlink" title="添加列功能"></a>添加列功能</h2><h3 id="trObject-insertCell-index"><a href="#trObject-insertCell-index" class="headerlink" title="trObject.insertCell( index )"></a><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-tablerow-insertcell.html">trObject.insertCell( index )</a></h3><p>insertCell() 方法用于在 HTML 表的一行的指定位置插入一个空的 &lt;td&gt; 元素。<br>新单元格将被插入当前位于 index 指定位置的表元之前。如果 index 等于行中的单元格数，则新单元格被附加在行的末尾。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   *  insertCell( index ) table的原生方法,参数传的是添加的位置</span></span><br><span class="line"><span class="comment">   * 需要注意的是添加之后要重新给列表宽度赋值</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  addCell: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; table.rows.length; i++) &#123;</span><br><span class="line">		<span class="keyword">var</span> newCell = table.rows[i].insertCell(<span class="built_in">this</span>.table.colspan)</span><br><span class="line">		newCell.innerHTML = <span class="string">&#x27;new add&#x27;</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; table.rows[i].cells.length; j++) &#123;</span><br><span class="line">			<span class="built_in">this</span>.table.rows[i].cells[j].style.width = <span class="number">900</span> / <span class="built_in">this</span>.table.rows[<span class="number">0</span>].cells.length + <span class="number">1</span> + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="添加行功能"><a href="#添加行功能" class="headerlink" title="添加行功能"></a>添加行功能</h2><h3 id="tableObject-insertRow-index"><a href="#tableObject-insertRow-index" class="headerlink" title="tableObject.insertRow( index )"></a><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-table-insertrow.html">tableObject.insertRow( index )</a></h3><p>insertRow() 方法用于在表格中的指定位置插入一个新行。<br>index : 指定插入新行的位置 (以 0 开始)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 被注释的那一段的想法是 在哪点击了就以点击的那一行为模板 在那行下面添加该行内容</span></span><br><span class="line"><span class="comment">   * 但是右侧的添加行功能 不能实现这一操作 就直接获取的第一行的内容来添加 </span></span><br><span class="line"><span class="comment">   * 应该是有bug的</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  addRow: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> newRow = <span class="built_in">this</span>.table.insertRow(<span class="built_in">this</span>.table.rowspan)</span><br><span class="line">	newRow.innerHTML = <span class="built_in">this</span>.table.rows[<span class="number">0</span>].innerHTML <span class="comment">//document.getSelection().getRangeAt(0).startContainer.parentNode.innerHTML</span></span><br><span class="line">&#125;, </span><br></pre></td></tr></table></figure>
<h2 id="合并功能"><a href="#合并功能" class="headerlink" title="合并功能"></a>合并功能</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 这个是我写的 直接获取选中的td 然后替换删除</span></span><br><span class="line"><span class="comment">   * 没有考虑到已经合并的情况 是有问题的</span></span><br><span class="line"><span class="comment"> * 我的想法是获取带有选中类的节点，创建一个新的节点 去替换</span></span><br><span class="line"><span class="comment"> * 其余的选中的节点自己删除</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  mergeTable: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> nodes = <span class="built_in">this</span>.table.getElementsByClassName(<span class="string">&#x27;ui-selected&#x27;</span>)</span><br><span class="line">	<span class="keyword">var</span> newNode = <span class="built_in">document</span>.createElement(<span class="string">&#x27;td&#x27;</span>)</span><br><span class="line">	<span class="keyword">var</span> parent = nodes[<span class="number">0</span>].parentNode</span><br><span class="line">	newNode.rowSpan = <span class="built_in">this</span>.table.rowspan</span><br><span class="line">	newNode.colSpan = <span class="built_in">this</span>.table.colspan</span><br><span class="line">	parent.replaceChild(newNode, nodes[<span class="number">0</span>])</span><br><span class="line">	<span class="keyword">while</span> (nodes[<span class="number">0</span>]) &#123;</span><br><span class="line">		nodes[<span class="number">0</span>].remove()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 这个是CSDN某大佬借助jquery写的 我没看懂QAQ</span></span><br><span class="line"><span class="comment">   * 原文地址 2楼： https://bbs.csdn.net/topics/391807641 </span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  mergeTable: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> $t = $(<span class="string">&quot;#&quot;</span> + <span class="built_in">this</span>.tableId);</span><br><span class="line">	<span class="keyword">if</span> ($(<span class="string">&quot;table&quot;</span>, $t).length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		alert(<span class="string">&quot;不支持嵌套表格！&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> sigDel = <span class="string">&quot;sign4delete&quot;</span>; <span class="comment">// 删除标记，用作类名</span></span><br><span class="line">	<span class="keyword">var</span> sigSel = <span class="string">&quot;ui-selected&quot;</span>; <span class="comment">// 选中标记，用作类名</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 补充单元格以便后继正确计算坐标</span></span><br><span class="line">	$(<span class="string">&quot;th,td&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="comment">// 坐标要实时计算，因会实时补充</span></span><br><span class="line">		<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">		<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> rowspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;rowspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">var</span> colspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;colspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">var</span> isSel = $(<span class="built_in">this</span>).hasClass(sigSel);</span><br><span class="line">		<span class="comment">// 非选单元格拆出的单元格要加删除标记</span></span><br><span class="line">		<span class="keyword">if</span> (rowspan &lt;= <span class="number">1</span> &amp;&amp; colspan &lt;= <span class="number">1</span>)</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		<span class="comment">// 跨格开插</span></span><br><span class="line">		$(<span class="string">&quot;tr&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> idx = $(<span class="string">&quot;tr&quot;</span>, $t).index(<span class="built_in">this</span>);</span><br><span class="line">			<span class="keyword">var</span> arr, $td = $(<span class="string">&quot;&lt;td&gt;&quot;</span>).addClass(isSel ? sigSel : sigDel);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (idx == ridx) &#123;</span><br><span class="line">				<span class="comment">// 本行在 [cidx] 后插入 colspan-1 个</span></span><br><span class="line"></span><br><span class="line">				arr = $(); <span class="comment">// 准备待插单元格</span></span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colspan - <span class="number">1</span>; i++)</span><br><span class="line">					arr = arr.add($td.clone());</span><br><span class="line">				<span class="comment">// 插入</span></span><br><span class="line">				$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).after(arr);</span><br><span class="line"></span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (ridx &lt; idx &amp;&amp; idx &lt; ridx + rowspan) &#123;</span><br><span class="line">				<span class="comment">// 以下行在 [cidx] 前插入 colspan 个</span></span><br><span class="line"></span><br><span class="line">				arr = $(); <span class="comment">// 准备待插单元格</span></span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colspan; i++)</span><br><span class="line">					arr = arr.add($td.clone());</span><br><span class="line">				<span class="comment">// 插入</span></span><br><span class="line">				<span class="keyword">if</span> (cidx &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).length &gt; <span class="number">0</span>)</span><br><span class="line">					$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).after(arr);</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> ($(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).length &gt; <span class="number">0</span>)</span><br><span class="line">					$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).before(arr);</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					$(<span class="built_in">this</span>).prepend(arr);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> rmin = <span class="number">10000</span>,</span><br><span class="line">		cmin = <span class="number">10000</span>;</span><br><span class="line">	<span class="keyword">var</span> rmax = <span class="number">0</span>,</span><br><span class="line">		cmax = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">var</span> rnum, cnum;</span><br><span class="line">	<span class="comment">// 计算起始和跨距</span></span><br><span class="line">	$(<span class="string">&quot;th,td&quot;</span>, $t).filter(<span class="string">&quot;.&quot;</span> + sigSel).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">		rmin = ridx &lt; rmin ? ridx : rmin;</span><br><span class="line">		rmax = ridx &gt; rmax ? ridx : rmax;</span><br><span class="line">		<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line">		cmin = cidx &lt; cmin ? cidx : cmin;</span><br><span class="line">		cmax = cidx &gt; cmax ? cidx : cmax;</span><br><span class="line">	&#125;);</span><br><span class="line">	rnum = rmax - rmin + <span class="number">1</span>;</span><br><span class="line">	cnum = cmax - cmin + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 合并单元格</span></span><br><span class="line">	$(<span class="string">&quot;th,td&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">		<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line">		<span class="comment">// 标记单元格待删</span></span><br><span class="line">		<span class="keyword">if</span> (rmin &lt;= ridx &amp;&amp; ridx &lt;= rmax &amp;&amp;</span><br><span class="line">			cmin &lt;= cidx &amp;&amp; cidx &lt;= cmax)</span><br><span class="line">			$(<span class="built_in">this</span>).addClass(sigDel);</span><br><span class="line">		<span class="comment">// 处理被选左上角单元格</span></span><br><span class="line">		<span class="keyword">if</span> (ridx == rmin &amp;&amp; cidx == cmin)</span><br><span class="line">			$(<span class="built_in">this</span>).removeClass(sigDel).attr(&#123;</span><br><span class="line">				rowspan: rnum,</span><br><span class="line">				colspan: cnum</span><br><span class="line">			&#125;);</span><br><span class="line">		<span class="comment">// 清理残余</span></span><br><span class="line">		<span class="keyword">if</span> ($(<span class="built_in">this</span>).attr(<span class="string">&quot;rowspan&quot;</span>) == <span class="number">1</span>) $(<span class="built_in">this</span>).removeAttr(<span class="string">&quot;rowspan&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span> ($(<span class="built_in">this</span>).attr(<span class="string">&quot;colspan&quot;</span>) == <span class="number">1</span>) $(<span class="built_in">this</span>).removeAttr(<span class="string">&quot;colspan&quot;</span>);</span><br><span class="line">	&#125;).remove(<span class="string">&quot;.&quot;</span> + sigDel);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="向下合并功能"><a href="#向下合并功能" class="headerlink" title="向下合并功能"></a>向下合并功能</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  mergeDown: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> row = <span class="built_in">document</span>.getSelection().anchorNode.parentNode.rowIndex</span><br><span class="line">	<span class="keyword">var</span> cell = <span class="built_in">document</span>.getSelection().anchorNode.cellIndex</span><br><span class="line">	<span class="keyword">var</span> node = <span class="built_in">document</span>.getSelection().anchorNode</span><br><span class="line">	<span class="keyword">if</span> (row != <span class="built_in">this</span>.table.rows.length - <span class="number">1</span> &amp;&amp; node.rowSpan == <span class="number">1</span>) &#123;</span><br><span class="line">		node.rowSpan = <span class="number">2</span></span><br><span class="line">		<span class="built_in">this</span>.table.rows[row + <span class="number">1</span>].cells[cell].remove()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,    </span><br></pre></td></tr></table></figure>
<h2 id="向右合并功能"><a href="#向右合并功能" class="headerlink" title="向右合并功能"></a>向右合并功能</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  mergeRight: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> cell = <span class="built_in">document</span>.getSelection().anchorNode.cellIndex</span><br><span class="line">	<span class="keyword">var</span> node = <span class="built_in">document</span>.getSelection().anchorNode</span><br><span class="line">	<span class="keyword">if</span> (cell != <span class="number">0</span> &amp;&amp; node.colSpan == <span class="number">1</span>) &#123;</span><br><span class="line">		node.previousElementSibling.remove()</span><br><span class="line">		node.colSpan = <span class="number">2</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="拆分功能"><a href="#拆分功能" class="headerlink" title="拆分功能"></a>拆分功能</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 我实现的 因为在ueditor里面是只可以拆分两格的</span></span><br><span class="line"><span class="comment">   * 我就按照它的写的 只能拆分两格的</span></span><br><span class="line"><span class="comment">   * 但是多格拆分应该也差不多</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> splitTable: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> node = <span class="built_in">document</span>.getSelection().anchorNode</span><br><span class="line">	<span class="keyword">var</span> td = <span class="built_in">document</span>.createElement(<span class="string">&#x27;td&#x27;</span>)</span><br><span class="line">	<span class="keyword">if</span> (node.rowSpan == <span class="number">2</span> &amp;&amp; node.colSpan == <span class="number">1</span>) &#123;</span><br><span class="line">		node.rowSpan = <span class="number">1</span></span><br><span class="line">		node.parentNode.nextElementSibling.appendChild(td)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.colSpan == <span class="number">2</span> &amp;&amp; node.rowSpan == <span class="number">1</span>) &#123;</span><br><span class="line">		node.colSpan = <span class="number">1</span></span><br><span class="line">		node.parentNode.appendChild(td)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 也是那个大佬的代码 可以拆分多个单元格</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  splitTable: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> $t = $(<span class="string">&quot;#&quot;</span>+<span class="built_in">this</span>.tableId);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> ($(<span class="string">&quot;table&quot;</span>, $t).length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			alert(<span class="string">&quot;不支持嵌套表格！&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">var</span> sigDel = <span class="string">&quot;sign4delete&quot;</span>;  <span class="comment">// 删除标记，类名，自定义</span></span><br><span class="line">		<span class="keyword">var</span> sigSel = <span class="string">&quot;ui-selected&quot;</span>;  <span class="comment">// 选中标记，类名，jQuery UI 定义</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 补充单元格以便后继正确计算坐标</span></span><br><span class="line">		$(<span class="string">&quot;th,td&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="comment">// 坐标要实时计算，因会实时补充</span></span><br><span class="line">			<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">			<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line">			<span class="keyword">var</span> rowspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;rowspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">var</span> colspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;colspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">var</span> isSel = $(<span class="built_in">this</span>).hasClass(sigSel);</span><br><span class="line">			<span class="comment">// 非选单元格拆出的单元格要加删除标记</span></span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span> (rowspan &lt;= <span class="number">1</span> &amp;&amp; colspan &lt;= <span class="number">1</span>)</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span> (isSel)</span><br><span class="line">				$(<span class="built_in">this</span>).removeAttr(<span class="string">&quot;colspan&quot;</span>).removeAttr(<span class="string">&quot;rowspan&quot;</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 跨格开插</span></span><br><span class="line">			$(<span class="string">&quot;tr&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">				<span class="keyword">var</span> idx = $(<span class="string">&quot;tr&quot;</span>, $t).index(<span class="built_in">this</span>);</span><br><span class="line">				<span class="keyword">var</span> arr, $td = $(<span class="string">&quot;&lt;td&gt;&quot;</span>);</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span> (!isSel)</span><br><span class="line">					$td.addClass(sigDel);</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span> (idx == ridx) &#123;</span><br><span class="line">					<span class="comment">// 本行在 [cidx] 后插入 colspan-1 个</span></span><br><span class="line">					</span><br><span class="line">					arr = $();  <span class="comment">// 准备待插单元格</span></span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; colspan<span class="number">-1</span>; i++)</span><br><span class="line">						arr = arr.add($td.clone());</span><br><span class="line">					</span><br><span class="line">					$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).after(arr);</span><br><span class="line">					</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (ridx &lt; idx &amp;&amp; idx &lt; ridx + rowspan) &#123;</span><br><span class="line">					<span class="comment">// 以下行在 [cidx] 前插入 colspan 个</span></span><br><span class="line">					</span><br><span class="line">					arr = $();  <span class="comment">// 准备待插单元格</span></span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; colspan; i++)</span><br><span class="line">						arr = arr.add($td.clone());</span><br><span class="line">					</span><br><span class="line">					<span class="keyword">if</span> (cidx &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).length &gt; <span class="number">0</span>)</span><br><span class="line">						$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).after(arr);</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span> ($(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).length &gt; <span class="number">0</span>)</span><br><span class="line">						$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).before(arr);</span><br><span class="line">					<span class="keyword">else</span></span><br><span class="line">						$(<span class="built_in">this</span>).prepend(arr);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 重新获取以取到删者并删之</span></span><br><span class="line">		$(<span class="string">&quot;th,td&quot;</span>, $t).remove(<span class="string">&quot;.&quot;</span> + sigDel);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="鼠标长按选中事件"><a href="#鼠标长按选中事件" class="headerlink" title="鼠标长按选中事件"></a>鼠标长按选中事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 点击选取范围那还是有问题的不知道怎么解决</span></span><br><span class="line"><span class="comment">    * 主要是针对已经合并的单元格 怎么遍历的问题</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">   <span class="built_in">this</span>.table.onmousedown = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// 鼠标按下的时候获取所在单元格的坐标，和鼠标按下的时间</span></span><br><span class="line">	<span class="built_in">this</span>.startRow = e.target.parentNode.rowIndex</span><br><span class="line">	<span class="built_in">this</span>.startCell = e.target.cellIndex</span><br><span class="line">	<span class="built_in">this</span>.startDate = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="built_in">this</span>.table.onmouseup = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// 通过和鼠标抬起事件所获取的时间进行对比 判断是否是长按鼠标事件</span></span><br><span class="line">	<span class="keyword">var</span> isClick = <span class="keyword">new</span> <span class="built_in">Date</span>() - <span class="built_in">this</span>.startDate &lt; <span class="number">500</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 获取鼠标抬起时 鼠标所在单元格的坐标点</span></span><br><span class="line">	<span class="keyword">var</span> endCell = event.target.cellIndex</span><br><span class="line">	<span class="keyword">var</span> endRow = event.target.parentNode.rowIndex</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!isClick) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="built_in">Math</span>.min(endRow, <span class="built_in">this</span>.startRow); i &lt;= <span class="built_in">Math</span>.max(endRow, <span class="built_in">this</span>.startRow); i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="built_in">Math</span>.min(endCell, <span class="built_in">this</span>.startCell); j &lt;= <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell); j++) &#123;</span><br><span class="line">				<span class="comment">// 以获取对角坐标 填充选中的区域  只能针对结构未改变的table</span></span><br><span class="line">				<span class="comment">//this.rows[i].cells[j].className = &#x27;ui-selected&#x27;</span></span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i].cells[j]) &#123;</span><br><span class="line">					<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i].cells[j].rowSpan &gt; <span class="number">1</span>) &#123;</span><br><span class="line">						<span class="keyword">if</span> (j == <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell)) &#123;</span><br><span class="line">							<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">1</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">								<span class="keyword">if</span>(<span class="built_in">this</span>.rows[i + a].cells[j])&#123;</span><br><span class="line">									<span class="built_in">this</span>.rows[i + a].cells[j].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;<span class="keyword">else</span> <span class="keyword">if</span>((j + table.rows[i].cells[j].colSpan - <span class="number">1</span> )== <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell))&#123;</span><br><span class="line">							<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">1</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">								<span class="keyword">for</span> (<span class="keyword">let</span> b = <span class="number">0</span>; b &lt; <span class="built_in">this</span>.rows[i].cells[j].colSpan; b++) &#123;</span><br><span class="line">									<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i + a].cells[j+b]) &#123;</span><br><span class="line">										<span class="built_in">this</span>.rows[i + a].cells[j+b].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">									&#125;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							 <span class="keyword">var</span> maxJ = <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell)</span><br><span class="line">							<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">0</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">								<span class="keyword">if</span> (table.rows[i + a].cells[maxJ]) &#123;</span><br><span class="line">									<span class="built_in">this</span>.rows[i + a].cells[maxJ].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">								&#125;</span><br><span class="line">							&#125; </span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i].cells[j].colSpan &gt; <span class="number">1</span>) &#123;</span><br><span class="line">						<span class="keyword">if</span> (j !== endCell &amp;&amp; j !== <span class="built_in">this</span>.startCell) &#123;</span><br><span class="line">							<span class="keyword">for</span> (<span class="keyword">let</span> b = <span class="number">1</span>; b &lt; <span class="built_in">this</span>.rows[i].cells[j].colSpan; b++) &#123;</span><br><span class="line">								<span class="keyword">if</span>(<span class="built_in">this</span>.rows[i].cells[j + b])&#123;</span><br><span class="line">									<span class="built_in">this</span>.rows[i].cells[j + b].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">								&#125;			</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;<span class="keyword">else</span> <span class="keyword">if</span>((j + table.rows[i].cells[j].colSpan - <span class="number">1</span> )== <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell))&#123;</span><br><span class="line">							<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">0</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">								<span class="keyword">for</span> (<span class="keyword">let</span> b = <span class="number">1</span>; b &lt; <span class="built_in">this</span>.rows[i].cells[j].colSpan; b++) &#123;</span><br><span class="line">									<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i + a].cells[j+b]) &#123;</span><br><span class="line">										<span class="built_in">this</span>.rows[i + a].cells[j+b].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">									&#125;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;	</span><br><span class="line">						&#125; </span><br><span class="line">						<span class="keyword">else</span> &#123;</span><br><span class="line">							<span class="built_in">this</span>.rows[i].cells[j].className = <span class="string">&#x27;&#x27;</span></span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="built_in">this</span>.rows[i].cells[j].className += <span class="string">&#x27;ui-selected&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 在table中增加两个属性 获取到跨的行和列 供合并单元格</span></span><br><span class="line">		<span class="built_in">this</span>.rowspan = <span class="built_in">Math</span>.abs(endRow - <span class="built_in">this</span>.startRow) + <span class="number">1</span></span><br><span class="line">		<span class="built_in">this</span>.colspan = <span class="built_in">Math</span>.abs(endCell - <span class="built_in">this</span>.startCell) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">// 清空样式</span></span><br><span class="line">		<span class="built_in">this</span>.rowspan = endRow</span><br><span class="line">		<span class="built_in">this</span>.colspan = endCell</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; table.rows.length; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; table.rows[i].cells.length; j++) &#123;</span><br><span class="line">				<span class="built_in">this</span>.rows[i].cells[j].className = <span class="string">&#x27;&#x27;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="鼠标进入离开显示添加行列"><a href="#鼠标进入离开显示添加行列" class="headerlink" title="鼠标进入离开显示添加行列"></a>鼠标进入离开显示添加行列</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * offset值好像是按照鼠标离每个td的位置不是离tr的位置</span></span><br><span class="line"><span class="comment">    * 所以需要利用client来处理下距离的判断</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">   <span class="built_in">this</span>.table.onmouseleave = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">		addCellBtn.style.display = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">		addRowBtn.style.display = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">	&#125;, <span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">this</span>.table.onmousemove = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (event.clientX - <span class="built_in">this</span>.offsetLeft &gt;= <span class="number">8</span> &amp;&amp; event.clientX - <span class="built_in">this</span>.offsetLeft &lt;= <span class="number">20</span>) &#123;</span><br><span class="line">		<span class="built_in">this</span>.style.cursor = <span class="string">&quot;url(&#x27;img/right.png&#x27;) , auto&quot;</span></span><br><span class="line">		<span class="built_in">this</span>.colspan = <span class="built_in">this</span>.rows.length</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (event.clientY - <span class="built_in">this</span>.offsetTop &gt;= <span class="number">52</span> &amp;&amp; event.clientY - <span class="built_in">this</span>.offsetTop &lt;= <span class="number">60</span>) &#123;</span><br><span class="line">		<span class="built_in">this</span>.style.cursor = <span class="string">&quot;url(&#x27;img/down.png&#x27;) , auto&quot;</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.style.cursor = <span class="string">&#x27;auto&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="鼠标点击选中一行一列事件"><a href="#鼠标点击选中一行一列事件" class="headerlink" title="鼠标点击选中一行一列事件"></a>鼠标点击选中一行一列事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 判断鼠标的指针状态然后执行点击事件 选中一行/列</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">   <span class="built_in">this</span>.table.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">this</span>.style.cursor !== <span class="string">&#x27;auto&#x27;</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">this</span>.style.cursor.includes(<span class="string">&#x27;down&#x27;</span>)) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.rows.length; i++) &#123;</span><br><span class="line">					<span class="built_in">this</span>.rows[i].cells[e.target.cellIndex].className = <span class="string">&#x27;ui-selected&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">this</span>.rowspan = <span class="built_in">this</span>.rows.length</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.rows[e.target.parentNode.rowIndex].cells.length; i++) &#123;</span><br><span class="line">					<span class="built_in">this</span>.rows[e.target.parentNode.rowIndex].cells[i].className = <span class="string">&#x27;ui-selected&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">this</span>.colspan = <span class="built_in">this</span>.rows[e.target.parentNode.rowIndex].cells.length</span><br><span class="line">				<span class="built_in">this</span>.rowspan = <span class="number">1</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JavaScript封装成类的完整代码"><a href="#JavaScript封装成类的完整代码" class="headerlink" title="JavaScript封装成类的完整代码"></a>JavaScript封装成类的完整代码</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">win</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> win_ = win;</span><br><span class="line">	<span class="keyword">var</span> kclass = <span class="function"><span class="keyword">function</span> (<span class="params">tableId</span>) </span>&#123;</span><br><span class="line">		<span class="built_in">this</span>._init.call(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	kclass.fn = &#123;</span><br><span class="line"></span><br><span class="line">		tableId: <span class="string">&quot;table&quot;</span>,</span><br><span class="line">		table: <span class="literal">null</span>,</span><br><span class="line">		delTable: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="built_in">this</span>.table.remove()</span><br><span class="line">		&#125;,</span><br><span class="line">		addCell: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; table.rows.length; i++) &#123;</span><br><span class="line">				<span class="keyword">var</span> newCell = table.rows[i].insertCell(<span class="built_in">this</span>.table.colspan)</span><br><span class="line">				newCell.innerHTML = <span class="string">&#x27;new add&#x27;</span></span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; table.rows[i].cells.length; j++) &#123;</span><br><span class="line">					<span class="built_in">this</span>.table.rows[i].cells[j].style.width = <span class="number">900</span> / <span class="built_in">this</span>.table.rows[<span class="number">0</span>].cells.length + <span class="number">1</span> + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		addRow: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> newRow = <span class="built_in">this</span>.table.insertRow(<span class="built_in">this</span>.table.rowspan)</span><br><span class="line">			newRow.innerHTML = <span class="built_in">this</span>.table.rows[<span class="number">0</span>].innerHTML <span class="comment">//document.getSelection().getRangeAt(0).startContainer.parentNode.innerHTML</span></span><br><span class="line">		&#125;,</span><br><span class="line">		mergeTable: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> $t = $(<span class="string">&quot;#&quot;</span> + <span class="built_in">this</span>.tableId);</span><br><span class="line">			<span class="keyword">if</span> ($(<span class="string">&quot;table&quot;</span>, $t).length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				alert(<span class="string">&quot;不支持嵌套表格！&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">var</span> sigDel = <span class="string">&quot;sign4delete&quot;</span>; <span class="comment">// 删除标记，用作类名</span></span><br><span class="line">			<span class="keyword">var</span> sigSel = <span class="string">&quot;ui-selected&quot;</span>; <span class="comment">// 选中标记，用作类名</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// 补充单元格以便后继正确计算坐标</span></span><br><span class="line">			$(<span class="string">&quot;th,td&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				<span class="comment">// 坐标要实时计算，因会实时补充</span></span><br><span class="line">				<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">				<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">var</span> rowspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;rowspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">var</span> colspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;colspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">var</span> isSel = $(<span class="built_in">this</span>).hasClass(sigSel);</span><br><span class="line">				<span class="comment">// 非选单元格拆出的单元格要加删除标记</span></span><br><span class="line">				<span class="keyword">if</span> (rowspan &lt;= <span class="number">1</span> &amp;&amp; colspan &lt;= <span class="number">1</span>)</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line">				<span class="comment">// 跨格开插</span></span><br><span class="line">				$(<span class="string">&quot;tr&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">					<span class="keyword">var</span> idx = $(<span class="string">&quot;tr&quot;</span>, $t).index(<span class="built_in">this</span>);</span><br><span class="line">					<span class="keyword">var</span> arr, $td = $(<span class="string">&quot;&lt;td&gt;&quot;</span>).addClass(isSel ? sigSel : sigDel);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span> (idx == ridx) &#123;</span><br><span class="line">						<span class="comment">// 本行在 [cidx] 后插入 colspan-1 个</span></span><br><span class="line"></span><br><span class="line">						arr = $(); <span class="comment">// 准备待插单元格</span></span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colspan - <span class="number">1</span>; i++)</span><br><span class="line">							arr = arr.add($td.clone());</span><br><span class="line">						<span class="comment">// 插入</span></span><br><span class="line">						$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).after(arr);</span><br><span class="line"></span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (ridx &lt; idx &amp;&amp; idx &lt; ridx + rowspan) &#123;</span><br><span class="line">						<span class="comment">// 以下行在 [cidx] 前插入 colspan 个</span></span><br><span class="line"></span><br><span class="line">						arr = $(); <span class="comment">// 准备待插单元格</span></span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colspan; i++)</span><br><span class="line">							arr = arr.add($td.clone());</span><br><span class="line">						<span class="comment">// 插入</span></span><br><span class="line">						<span class="keyword">if</span> (cidx &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).length &gt; <span class="number">0</span>)</span><br><span class="line">							$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).after(arr);</span><br><span class="line">						<span class="keyword">else</span> <span class="keyword">if</span> ($(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).length &gt; <span class="number">0</span>)</span><br><span class="line">							$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).before(arr);</span><br><span class="line">						<span class="keyword">else</span></span><br><span class="line">							$(<span class="built_in">this</span>).prepend(arr);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">var</span> rmin = <span class="number">10000</span>,</span><br><span class="line">				cmin = <span class="number">10000</span>;</span><br><span class="line">			<span class="keyword">var</span> rmax = <span class="number">0</span>,</span><br><span class="line">				cmax = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">var</span> rnum, cnum;</span><br><span class="line">			<span class="comment">// 计算起始和跨距</span></span><br><span class="line">			$(<span class="string">&quot;th,td&quot;</span>, $t).filter(<span class="string">&quot;.&quot;</span> + sigSel).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">				rmin = ridx &lt; rmin ? ridx : rmin;</span><br><span class="line">				rmax = ridx &gt; rmax ? ridx : rmax;</span><br><span class="line">				<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line">				cmin = cidx &lt; cmin ? cidx : cmin;</span><br><span class="line">				cmax = cidx &gt; cmax ? cidx : cmax;</span><br><span class="line">			&#125;);</span><br><span class="line">			rnum = rmax - rmin + <span class="number">1</span>;</span><br><span class="line">			cnum = cmax - cmin + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 合并单元格</span></span><br><span class="line">			$(<span class="string">&quot;th,td&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">				<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line">				<span class="comment">// 标记单元格待删</span></span><br><span class="line">				<span class="keyword">if</span> (rmin &lt;= ridx &amp;&amp; ridx &lt;= rmax &amp;&amp;</span><br><span class="line">					cmin &lt;= cidx &amp;&amp; cidx &lt;= cmax)</span><br><span class="line">					$(<span class="built_in">this</span>).addClass(sigDel);</span><br><span class="line">				<span class="comment">// 处理被选左上角单元格</span></span><br><span class="line">				<span class="keyword">if</span> (ridx == rmin &amp;&amp; cidx == cmin)</span><br><span class="line">					$(<span class="built_in">this</span>).removeClass(sigDel).attr(&#123;</span><br><span class="line">						rowspan: rnum,</span><br><span class="line">						colspan: cnum</span><br><span class="line">					&#125;);</span><br><span class="line">				<span class="comment">// 清理残余</span></span><br><span class="line">				<span class="keyword">if</span> ($(<span class="built_in">this</span>).attr(<span class="string">&quot;rowspan&quot;</span>) == <span class="number">1</span>) $(<span class="built_in">this</span>).removeAttr(<span class="string">&quot;rowspan&quot;</span>);</span><br><span class="line">				<span class="keyword">if</span> ($(<span class="built_in">this</span>).attr(<span class="string">&quot;colspan&quot;</span>) == <span class="number">1</span>) $(<span class="built_in">this</span>).removeAttr(<span class="string">&quot;colspan&quot;</span>);</span><br><span class="line">			&#125;).remove(<span class="string">&quot;.&quot;</span> + sigDel);</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		mergeTable: function () &#123;</span></span><br><span class="line"><span class="comment">			var nodes = this.table.getElementsByClassName(&#x27;ui-selected&#x27;)</span></span><br><span class="line"><span class="comment">			var newNode = document.createElement(&#x27;td&#x27;)</span></span><br><span class="line"><span class="comment">			var parent = nodes[0].parentNode</span></span><br><span class="line"><span class="comment">			newNode.rowSpan = this.table.rowspan</span></span><br><span class="line"><span class="comment">			newNode.colSpan = this.table.colspan</span></span><br><span class="line"><span class="comment">			parent.replaceChild(newNode, nodes[0])</span></span><br><span class="line"><span class="comment">			while (nodes[0]) &#123;</span></span><br><span class="line"><span class="comment">				nodes[0].remove()</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;,*/</span></span><br><span class="line">		mergeDown: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> row = <span class="built_in">document</span>.getSelection().anchorNode.parentNode.rowIndex</span><br><span class="line">			<span class="keyword">var</span> cell = <span class="built_in">document</span>.getSelection().anchorNode.cellIndex</span><br><span class="line">			<span class="keyword">var</span> node = <span class="built_in">document</span>.getSelection().anchorNode</span><br><span class="line">			<span class="keyword">if</span> (row != <span class="built_in">this</span>.table.rows.length - <span class="number">1</span> &amp;&amp; node.rowSpan == <span class="number">1</span>) &#123;</span><br><span class="line">				node.rowSpan = <span class="number">2</span></span><br><span class="line">				<span class="built_in">this</span>.table.rows[row + <span class="number">1</span>].cells[cell].remove()</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		mergeRight: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> cell = <span class="built_in">document</span>.getSelection().anchorNode.cellIndex</span><br><span class="line">			<span class="keyword">var</span> node = <span class="built_in">document</span>.getSelection().anchorNode</span><br><span class="line">			<span class="keyword">if</span> (cell != <span class="number">0</span> &amp;&amp; node.colSpan == <span class="number">1</span>) &#123;</span><br><span class="line">				node.previousElementSibling.remove()</span><br><span class="line">				node.colSpan = <span class="number">2</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		splitTable: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> $t = $(<span class="string">&quot;#&quot;</span> + <span class="built_in">this</span>.tableId);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> ($(<span class="string">&quot;table&quot;</span>, $t).length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				alert(<span class="string">&quot;不支持嵌套表格！&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">var</span> sigDel = <span class="string">&quot;sign4delete&quot;</span>; <span class="comment">// 删除标记，类名，自定义</span></span><br><span class="line">			<span class="keyword">var</span> sigSel = <span class="string">&quot;ui-selected&quot;</span>; <span class="comment">// 选中标记，类名，jQuery UI 定义</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// 补充单元格以便后继正确计算坐标</span></span><br><span class="line">			$(<span class="string">&quot;th,td&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				<span class="comment">// 坐标要实时计算，因会实时补充</span></span><br><span class="line">				<span class="keyword">var</span> ridx = $(<span class="string">&quot;tr&quot;</span>, $t).index($(<span class="built_in">this</span>).parent(<span class="string">&quot;tr&quot;</span>));</span><br><span class="line">				<span class="keyword">var</span> cidx = $(<span class="built_in">this</span>).parent().children(<span class="string">&quot;th,td&quot;</span>).index(<span class="built_in">this</span>);</span><br><span class="line">				<span class="keyword">var</span> rowspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;rowspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">var</span> colspan = <span class="built_in">Number</span>($(<span class="built_in">this</span>).attr(<span class="string">&quot;colspan&quot;</span>)) || <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">var</span> isSel = $(<span class="built_in">this</span>).hasClass(sigSel);</span><br><span class="line">				<span class="comment">// 非选单元格拆出的单元格要加删除标记</span></span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (rowspan &lt;= <span class="number">1</span> &amp;&amp; colspan &lt;= <span class="number">1</span>)</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (isSel)</span><br><span class="line">					$(<span class="built_in">this</span>).removeAttr(<span class="string">&quot;colspan&quot;</span>).removeAttr(<span class="string">&quot;rowspan&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="comment">// 跨格开插</span></span><br><span class="line">				$(<span class="string">&quot;tr&quot;</span>, $t).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">					<span class="keyword">var</span> idx = $(<span class="string">&quot;tr&quot;</span>, $t).index(<span class="built_in">this</span>);</span><br><span class="line">					<span class="keyword">var</span> arr, $td = $(<span class="string">&quot;&lt;td&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span> (!isSel)</span><br><span class="line">						$td.addClass(sigDel);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span> (idx == ridx) &#123;</span><br><span class="line">						<span class="comment">// 本行在 [cidx] 后插入 colspan-1 个</span></span><br><span class="line"></span><br><span class="line">						arr = $(); <span class="comment">// 准备待插单元格</span></span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colspan - <span class="number">1</span>; i++)</span><br><span class="line">							arr = arr.add($td.clone());</span><br><span class="line"></span><br><span class="line">						$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).after(arr);</span><br><span class="line"></span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (ridx &lt; idx &amp;&amp; idx &lt; ridx + rowspan) &#123;</span><br><span class="line">						<span class="comment">// 以下行在 [cidx] 前插入 colspan 个</span></span><br><span class="line"></span><br><span class="line">						arr = $(); <span class="comment">// 准备待插单元格</span></span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; colspan; i++)</span><br><span class="line">							arr = arr.add($td.clone());</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (cidx &gt; <span class="number">0</span> &amp;&amp; $(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).length &gt; <span class="number">0</span>)</span><br><span class="line">							$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx - <span class="number">1</span>).after(arr);</span><br><span class="line">						<span class="keyword">else</span> <span class="keyword">if</span> ($(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).length &gt; <span class="number">0</span>)</span><br><span class="line">							$(<span class="string">&quot;th,td&quot;</span>, <span class="built_in">this</span>).eq(cidx).before(arr);</span><br><span class="line">						<span class="keyword">else</span></span><br><span class="line">							$(<span class="built_in">this</span>).prepend(arr);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// 重新获取以取到删者并删之</span></span><br><span class="line">			$(<span class="string">&quot;th,td&quot;</span>, $t).remove(<span class="string">&quot;.&quot;</span> + sigDel);</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		splitTable: function () &#123;</span></span><br><span class="line"><span class="comment">			var node = document.getSelection().anchorNode</span></span><br><span class="line"><span class="comment">			var td = document.createElement(&#x27;td&#x27;)</span></span><br><span class="line"><span class="comment">			if (node.rowSpan == 2 &amp;&amp; node.colSpan == 1) &#123;</span></span><br><span class="line"><span class="comment">				node.rowSpan = 1</span></span><br><span class="line"><span class="comment">				node.parentNode.nextElementSibling.appendChild(td)</span></span><br><span class="line"><span class="comment">			&#125; else if (node.colSpan == 2 &amp;&amp; node.rowSpan == 1) &#123;</span></span><br><span class="line"><span class="comment">				node.colSpan = 1</span></span><br><span class="line"><span class="comment">				node.parentNode.appendChild(td)</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;,*/</span></span><br><span class="line">		addEvent: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="built_in">document</span>.body.onmouseup = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		_init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">var</span> tableId = <span class="built_in">arguments</span>[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">if</span> (!tableId)</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;table id cannot be null&quot;</span>);</span><br><span class="line">			<span class="keyword">var</span> table = <span class="built_in">document</span>.getElementById(tableId);</span><br><span class="line">			<span class="keyword">if</span> (!table || table.nodeName.toUpperCase() != <span class="string">&#x27;TABLE&#x27;</span>) &#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;canot find the table,please enter the right id&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// 侧边和底部的新增按钮</span></span><br><span class="line">			<span class="keyword">var</span> addCellBtn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;addCell&#x27;</span>)</span><br><span class="line">			<span class="keyword">var</span> addRowBtn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;addRow&#x27;</span>)</span><br><span class="line">			<span class="built_in">this</span>.tableId = tableId;</span><br><span class="line">			<span class="built_in">this</span>.table = table;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//使表格可选</span></span><br><span class="line">			<span class="built_in">this</span>.table.onmousedown = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">				<span class="comment">// 鼠标按下的时候获取所在单元格的坐标，和鼠标按下的时间</span></span><br><span class="line">				<span class="built_in">this</span>.startRow = e.target.parentNode.rowIndex</span><br><span class="line">				<span class="built_in">this</span>.startCell = e.target.cellIndex</span><br><span class="line">				<span class="built_in">this</span>.startDate = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">this</span>.table.onmouseup = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				<span class="comment">// 通过和鼠标抬起事件所获取的时间进行对比 判断是否是长按鼠标事件</span></span><br><span class="line">				<span class="keyword">var</span> isClick = <span class="keyword">new</span> <span class="built_in">Date</span>() - <span class="built_in">this</span>.startDate &lt; <span class="number">500</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">				<span class="comment">// 获取鼠标抬起时 鼠标所在单元格的坐标点</span></span><br><span class="line">				<span class="keyword">var</span> endCell = event.target.cellIndex</span><br><span class="line">				<span class="keyword">var</span> endRow = event.target.parentNode.rowIndex</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (!isClick) &#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="built_in">Math</span>.min(endRow, <span class="built_in">this</span>.startRow); i &lt;= <span class="built_in">Math</span>.max(endRow, <span class="built_in">this</span>.startRow); i++) &#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="built_in">Math</span>.min(endCell, <span class="built_in">this</span>.startCell); j &lt;= <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell); j++) &#123;</span><br><span class="line">							<span class="comment">// 以获取对角坐标 填充选中的区域</span></span><br><span class="line">							<span class="comment">//this.rows[i].cells[j].className = &#x27;ui-selected&#x27;</span></span><br><span class="line"></span><br><span class="line">							<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i].cells[j]) &#123;</span><br><span class="line">								<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i].cells[j].rowSpan &gt; <span class="number">1</span>) &#123;</span><br><span class="line">									<span class="keyword">if</span> (j == <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell)) &#123;</span><br><span class="line">										<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">1</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">											<span class="keyword">if</span>(<span class="built_in">this</span>.rows[i + a].cells[j])&#123;</span><br><span class="line">												<span class="built_in">this</span>.rows[i + a].cells[j].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">											&#125;</span><br><span class="line">										&#125;</span><br><span class="line">									&#125;<span class="keyword">else</span> <span class="keyword">if</span>((j + table.rows[i].cells[j].colSpan - <span class="number">1</span> )== <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell))&#123;</span><br><span class="line">										<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">1</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">											<span class="keyword">for</span> (<span class="keyword">let</span> b = <span class="number">0</span>; b &lt; <span class="built_in">this</span>.rows[i].cells[j].colSpan; b++) &#123;</span><br><span class="line">												<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i + a].cells[j+b]) &#123;</span><br><span class="line">													<span class="built_in">this</span>.rows[i + a].cells[j+b].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">												&#125;</span><br><span class="line">											&#125;</span><br><span class="line">										&#125;</span><br><span class="line">									&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">										 <span class="keyword">var</span> maxJ = <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell)</span><br><span class="line">										<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">0</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">											<span class="keyword">if</span> (table.rows[i + a].cells[maxJ]) &#123;</span><br><span class="line">												<span class="built_in">this</span>.rows[i + a].cells[maxJ].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">											&#125;</span><br><span class="line">										&#125; </span><br><span class="line"></span><br><span class="line">									&#125;</span><br><span class="line">								&#125;</span><br><span class="line"></span><br><span class="line">								<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i].cells[j].colSpan &gt; <span class="number">1</span>) &#123;</span><br><span class="line">									<span class="keyword">if</span> (j !== endCell &amp;&amp; j !== <span class="built_in">this</span>.startCell) &#123;</span><br><span class="line">										<span class="keyword">for</span> (<span class="keyword">let</span> b = <span class="number">1</span>; b &lt; <span class="built_in">this</span>.rows[i].cells[j].colSpan; b++) &#123;</span><br><span class="line">											<span class="keyword">if</span>(<span class="built_in">this</span>.rows[i].cells[j + b])&#123;</span><br><span class="line">												<span class="built_in">this</span>.rows[i].cells[j + b].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">											&#125;			</span><br><span class="line">										&#125;</span><br><span class="line">									&#125;<span class="keyword">else</span> <span class="keyword">if</span>((j + table.rows[i].cells[j].colSpan - <span class="number">1</span> )== <span class="built_in">Math</span>.max(endCell, <span class="built_in">this</span>.startCell))&#123;</span><br><span class="line">										<span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">0</span>; a &lt; <span class="built_in">this</span>.rows[i].cells[j].rowSpan; a++) &#123;</span><br><span class="line">											<span class="keyword">for</span> (<span class="keyword">let</span> b = <span class="number">1</span>; b &lt; <span class="built_in">this</span>.rows[i].cells[j].colSpan; b++) &#123;</span><br><span class="line">												<span class="keyword">if</span> (<span class="built_in">this</span>.rows[i + a].cells[j+b]) &#123;</span><br><span class="line">													<span class="built_in">this</span>.rows[i + a].cells[j+b].className = <span class="string">&#x27;del&#x27;</span></span><br><span class="line">												&#125;</span><br><span class="line">											&#125;</span><br><span class="line">										&#125;	</span><br><span class="line">									&#125; </span><br><span class="line">									<span class="keyword">else</span> &#123;</span><br><span class="line">										<span class="built_in">this</span>.rows[i].cells[j].className = <span class="string">&#x27;&#x27;</span></span><br><span class="line">									&#125;</span><br><span class="line">								&#125;</span><br><span class="line">								<span class="built_in">this</span>.rows[i].cells[j].className += <span class="string">&#x27;ui-selected&#x27;</span></span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="comment">// 在table中增加两个属性 获取到跨的行和列 供合并单元格</span></span><br><span class="line">					<span class="built_in">this</span>.rowspan = <span class="built_in">Math</span>.abs(endRow - <span class="built_in">this</span>.startRow) + <span class="number">1</span></span><br><span class="line">					<span class="built_in">this</span>.colspan = <span class="built_in">Math</span>.abs(endCell - <span class="built_in">this</span>.startCell) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="comment">// 清空样式</span></span><br><span class="line">					<span class="built_in">this</span>.rowspan = endRow</span><br><span class="line">					<span class="built_in">this</span>.colspan = endCell</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; table.rows.length; i++) &#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; table.rows[i].cells.length; j++) &#123;</span><br><span class="line">							<span class="built_in">this</span>.rows[i].cells[j].className = <span class="string">&#x27;&#x27;</span></span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">this</span>.table.onmouseenter = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				addCellBtn.style.display = <span class="string">&#x27;inline-block&#x27;</span></span><br><span class="line">				addRowBtn.style.display = <span class="string">&#x27;block&#x27;</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">this</span>.table.onmouseleave = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				<span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">					addCellBtn.style.display = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">					addRowBtn.style.display = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">				&#125;, <span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">this</span>.table.onmousemove = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				<span class="keyword">if</span> (event.clientX - <span class="built_in">this</span>.offsetLeft &gt;= <span class="number">8</span> &amp;&amp; event.clientX - <span class="built_in">this</span>.offsetLeft &lt;= <span class="number">20</span>) &#123;</span><br><span class="line">					<span class="built_in">this</span>.style.cursor = <span class="string">&quot;url(&#x27;img/right.png&#x27;) , auto&quot;</span></span><br><span class="line">					<span class="built_in">this</span>.colspan = <span class="built_in">this</span>.rows.length</span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (event.clientY - <span class="built_in">this</span>.offsetTop &gt;= <span class="number">52</span> &amp;&amp; event.clientY - <span class="built_in">this</span>.offsetTop &lt;= <span class="number">60</span>) &#123;</span><br><span class="line">					<span class="built_in">this</span>.style.cursor = <span class="string">&quot;url(&#x27;img/down.png&#x27;) , auto&quot;</span></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="built_in">this</span>.style.cursor = <span class="string">&#x27;auto&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">this</span>.table.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">this</span>.style.cursor !== <span class="string">&#x27;auto&#x27;</span>) &#123;</span><br><span class="line">					<span class="keyword">if</span> (<span class="built_in">this</span>.style.cursor.includes(<span class="string">&#x27;down&#x27;</span>)) &#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.rows.length; i++) &#123;</span><br><span class="line">							<span class="built_in">this</span>.rows[i].cells[e.target.cellIndex].className = <span class="string">&#x27;ui-selected&#x27;</span></span><br><span class="line">						&#125;</span><br><span class="line">						<span class="built_in">this</span>.rowspan = <span class="built_in">this</span>.rows.length</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.rows[e.target.parentNode.rowIndex].cells.length; i++) &#123;</span><br><span class="line">							<span class="built_in">this</span>.rows[e.target.parentNode.rowIndex].cells[i].className = <span class="string">&#x27;ui-selected&#x27;</span></span><br><span class="line">						&#125;</span><br><span class="line">						<span class="built_in">this</span>.colspan = <span class="built_in">this</span>.rows[e.target.parentNode.rowIndex].cells.length</span><br><span class="line">						<span class="built_in">this</span>.rowspan = <span class="number">1</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	kclass.prototype = kclass.fn;</span><br><span class="line">	win_.ytable = (win_.ytable || kclass);</span><br><span class="line">&#125;)(<span class="built_in">window</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-方块运动"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/01/16/%E6%96%B9%E5%9D%97%E8%BF%90%E5%8A%A8/"
    >CSS3 立体轮播</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/01/16/%E6%96%B9%E5%9D%97%E8%BF%90%E5%8A%A8/" class="article-date">
  <time datetime="2020-01-16T09:16:00.000Z" itemprop="datePublished">2020-01-16</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/CSS/">CSS</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="CSS3-立体轮播"><a href="#CSS3-立体轮播" class="headerlink" title="CSS3 立体轮播"></a>CSS3 立体轮播</h2><p> 最近比较迷css，可能是JavaScript看的头疼<br> 可以用作图片轮播，换成小的立方体还可以当做是缓冲动画<br> 效果很好看 就是每次弄 旋转角度、移动位置的时候头疼<br> <del>没有找到方法</del>  就是我空间感不行</p>
<style>
    .cubeCover{
        width: 100px;
        height: 300px;
        margin-top: 150px;
        margin-left: 200px;
    }
    .cubeCover .cube{
        transform-style: preserve-3d;
        width: 100%;
        height: 100%;
        position: relative;
        transform: rotateY(20deg) rotateX(-20deg) ;
        animation: move1 6s linear infinite .75s;
    }
    .cubeCover .cube div{
        border: 1px solid #ccc;
        width: 100%;
        height: 100%;
        position: absolute;
    }
    .cubeCover .cube div:nth-child(1){
        transform:translateZ(-150px);
        background: url('/images/bottom.jpg');
        background-position: 0 0;
    }
    .cubeCover .cube div:nth-child(2){
        transform: rotateX(90deg) translateZ(150px);
        background: url('/images/side.jpg');
        background-position: 0 0;
    }
    .cubeCover .cube div:nth-child(3){
        transform:rotateX(90deg) translateZ(-150px)  ;
        background: url('/images/top.jpg');
    }
    .cubeCover .cube div:nth-child(4){
        width: 300px;
        transform: rotateY(90deg) translateZ(-150px);
        background: lightblue;
    }
    .cubeCover .cube div:nth-child(5){
        width: 300px;
        transform: rotateY(90deg) translateZ(-50px);
        background: lightblue;
    }
    .cubeCover .cube div:nth-child(6){
        transform: translateZ(150px);
        background: url('/images/avatar.jpg');
        background-position: 0 0;
    }
    .cubeCover .cube2{
        margin-top: -300px;
        margin-left: 90px;
        z-index: -1;
        animation: move1 6s linear infinite .5s;
    }
    .cubeCover .cube2 div:nth-child(1),.cubeCover .cube2 div:nth-child(2),.cubeCover .cube2 div:nth-child(3),.cubeCover .cube2 div:nth-child(6){
        background-position: -100px 0;
    }
    .cubeCover .cube3{
        margin-top: -300px;
        margin-left: 180px;
        z-index: -2;
        animation: move1 6s linear infinite .25s;
    }
    .cubeCover .cube3 div:nth-child(1),.cubeCover .cube3 div:nth-child(2),.cubeCover .cube3 div:nth-child(3),.cubeCover .cube3 div:nth-child(6){
        background-position: -200px 0;
    }
    .cubeCover .cube4{
        margin-top: -300px;
        margin-left: 270px;
        z-index: -3;
        animation: move1 6s linear infinite ;
    }
    .cubeCover .cube4 div:nth-child(1),.cubeCover .cube4 div:nth-child(2),.cubeCover .cube4 div:nth-child(3),.cubeCover .cube4 div:nth-child(6){
        background-position: -300px 0;
    }
    @keyframes move1 {
        12.5%,25%{
            transform:rotateY(20deg) rotateX(70deg);
        }
        42.5%,55%{
            transform:rotateY(20deg) rotateX(160deg);
        }
        62.5%,75%{
            transform:rotateY(20deg) rotateX(250deg);
        }
        92.5%,100%{
            transform:rotateY(20deg) rotateX(340deg);
        }
    }
</style>
<div class="cubeCover">
    <div class="cube">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
    <div class="cube cube2">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
    <div class="cube cube3">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
    <div class="cube cube4">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
</div>
<br>
<br>
<br>
<br>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span>&#123;</span></span><br><span class="line">        width: 100px;</span><br><span class="line">        height: 300px;</span><br><span class="line">        margin-top: 150px;</span><br><span class="line">        margin-left: 200px;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span>&#123;</span></span><br><span class="line">        transform-style: preserve-3d;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">        position: relative;</span><br><span class="line">        transform: rotateY(20deg) rotateX(-20deg) ;</span><br><span class="line"><span class="css">        <span class="selector-tag">animation</span>: <span class="selector-tag">move1</span> 6<span class="selector-tag">s</span> <span class="selector-tag">linear</span> <span class="selector-tag">infinite</span> <span class="selector-class">.75s</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span> <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span></span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">        position: absolute;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(1)</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">transform</span><span class="selector-pseudo">:translateZ(-150px)</span>;</span></span><br><span class="line">        background: url(&#x27;/images/bottom.jpg&#x27;);</span><br><span class="line">        background-position: 0 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(2)</span>&#123;</span></span><br><span class="line">        transform: rotateX(90deg) translateZ(150px);</span><br><span class="line">        background: url(&#x27;/images/side.jpg&#x27;);</span><br><span class="line">        background-position: 0 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(3)</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">transform</span><span class="selector-pseudo">:rotateX(90deg)</span> <span class="selector-tag">translateZ</span>(<span class="selector-tag">-150px</span>)  ;</span></span><br><span class="line">        background: url(&#x27;/images/top.jpg&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(4)</span>&#123;</span></span><br><span class="line">        width: 300px;</span><br><span class="line">        transform: rotateY(90deg) translateZ(-150px);</span><br><span class="line">        background: lightblue;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(5)</span>&#123;</span></span><br><span class="line">        width: 300px;</span><br><span class="line">        transform: rotateY(90deg) translateZ(-50px);</span><br><span class="line">        background: lightblue;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(6)</span>&#123;</span></span><br><span class="line">        transform: translateZ(150px);</span><br><span class="line">        background: url(&#x27;/images/avatar.jpg&#x27;);</span><br><span class="line">        background-position: 0 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube2</span>&#123;</span></span><br><span class="line">        margin-top: -300px;</span><br><span class="line">        margin-left: 90px;</span><br><span class="line">        z-index: -1;</span><br><span class="line"><span class="css">        <span class="selector-tag">animation</span>: <span class="selector-tag">move1</span> 6<span class="selector-tag">s</span> <span class="selector-tag">linear</span> <span class="selector-tag">infinite</span> <span class="selector-class">.5s</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube2</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(1)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube2</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(2)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube2</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(3)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube2</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(6)</span>&#123;</span></span><br><span class="line">        background-position: -100px 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube3</span>&#123;</span></span><br><span class="line">        margin-top: -300px;</span><br><span class="line">        margin-left: 180px;</span><br><span class="line">        z-index: -2;</span><br><span class="line"><span class="css">        <span class="selector-tag">animation</span>: <span class="selector-tag">move1</span> 6<span class="selector-tag">s</span> <span class="selector-tag">linear</span> <span class="selector-tag">infinite</span> <span class="selector-class">.25s</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube3</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(1)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube3</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(2)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube3</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(3)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube3</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(6)</span>&#123;</span></span><br><span class="line">        background-position: -200px 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube4</span>&#123;</span></span><br><span class="line">        margin-top: -300px;</span><br><span class="line">        margin-left: 270px;</span><br><span class="line">        z-index: -3;</span><br><span class="line">        animation: move1 6s linear infinite ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.cubeCover</span> <span class="selector-class">.cube4</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(1)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube4</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(2)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube4</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(3)</span>,<span class="selector-class">.cubeCover</span> <span class="selector-class">.cube4</span> <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child(6)</span>&#123;</span></span><br><span class="line">        background-position: -300px 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="keyword">@keyframes</span> move1 &#123;</span></span><br><span class="line"><span class="css">        12<span class="selector-class">.5</span>%,25%&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">transform</span><span class="selector-pseudo">:rotateY(20deg)</span> <span class="selector-tag">rotateX</span>(70<span class="selector-tag">deg</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        42<span class="selector-class">.5</span>%,55%&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">transform</span><span class="selector-pseudo">:rotateY(20deg)</span> <span class="selector-tag">rotateX</span>(160<span class="selector-tag">deg</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        62<span class="selector-class">.5</span>%,75%&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">transform</span><span class="selector-pseudo">:rotateY(20deg)</span> <span class="selector-tag">rotateX</span>(250<span class="selector-tag">deg</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        92<span class="selector-class">.5</span>%,100%&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">transform</span><span class="selector-pseudo">:rotateY(20deg)</span> <span class="selector-tag">rotateX</span>(340<span class="selector-tag">deg</span>);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cubeCover&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cube&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cube cube2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cube cube3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cube cube4&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-vue-element-admin权限管理&amp;动态路由配置"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/01/08/vue-element-admin%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86&%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE/"
    >vue-element-admin权限管理&amp;动态路由配置</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/01/08/vue-element-admin%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86&%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE/" class="article-date">
  <time datetime="2020-01-08T12:00:00.000Z" itemprop="datePublished">2020-01-08</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/bug%E6%94%B6%E9%9B%86%E7%AB%99/">bug收集站</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><a target="_blank" rel="noopener" href="https://panjiachen.gitee.io/vue-element-admin-site/zh/guide/">vue-element-admin模板地址</a></p>
<blockquote>
<p>需求: 调用登陆接口之后 后台传递路由数据给前端 进行动态创建和显示  </p>
</blockquote>
<blockquote>
<p>问题: 各种问题 主要是不清楚这个模板的默认权限动态传递的配置</p>
</blockquote>
<h3 id="用到的核心文件地址"><a href="#用到的核心文件地址" class="headerlink" title="用到的核心文件地址"></a>用到的核心文件地址</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">src&#x2F;router&#x2F;index.js                     路由</span><br><span class="line">src&#x2F;store&#x2F;modules&#x2F;user.js               用户登录，用户信息、路由信息传递</span><br><span class="line">src&#x2F;permission.js                       信息传递（user -&gt; permission 的中间商）  之前就是一直没注意到这个 导致一直弄不好</span><br><span class="line">src&#x2F;store&#x2F;modules&#x2F;permission.js         权限获取&amp;配置</span><br></pre></td></tr></table></figure>
<h3 id="src-router-index-js-路由配置"><a href="#src-router-index-js-路由配置" class="headerlink" title="src/router/index.js 路由配置"></a>src/router/index.js 路由配置</h3><blockquote>
<p>constantRoutes: 不需要动态判断权限的路由 eg：登陆、404等通用页面<br>asyncRoutes：需要动态判断权限并通过addRoutes动态添加的页面  </p>
</blockquote>
<p>需要把动态路由先配置好 ‘permission’ 权限要写好<br>到时候才能正确的获取和显示相应的权限</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> constantRoutes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">    component: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/login/index&#x27;</span>),</span><br><span class="line">    hidden: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    component: Layout,</span><br><span class="line">    redirect: <span class="string">&#x27;/dashboard&#x27;</span>,</span><br><span class="line">    children: [&#123;</span><br><span class="line">      path: <span class="string">&#x27;/dashboard&#x27;</span>,</span><br><span class="line">      name: <span class="string">&#x27;Dashboard&#x27;</span>,</span><br><span class="line">      component: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/dashboard/index&#x27;</span>),</span><br><span class="line">      meta: &#123; <span class="attr">title</span>: <span class="string">&#x27;首页&#x27;</span>, <span class="attr">icon</span>: <span class="string">&#x27;dashboard&#x27;</span>, <span class="attr">affix</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> asyncRoutes = [</span><br><span class="line">  <span class="comment">//  待审核</span></span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/toPend&#x27;</span>,</span><br><span class="line">    component: Layout,</span><br><span class="line">    redirect: <span class="string">&#x27;/toPend&#x27;</span>,</span><br><span class="line">    permission: <span class="string">&#x27;toPend&#x27;</span>,</span><br><span class="line">    title: <span class="string">&#x27;待审核&#x27;</span>,</span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        permission: <span class="string">&#x27;toPend&#x27;</span>,</span><br><span class="line">        path: <span class="string">&#x27;/toPendIndex&#x27;</span>,</span><br><span class="line">        component: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/toPendManagement/toPendIndex&#x27;</span>),</span><br><span class="line">        name: <span class="string">&#x27;toPend&#x27;</span>,</span><br><span class="line">        meta: &#123;</span><br><span class="line">          title: <span class="string">&#x27;待审核&#x27;</span>,</span><br><span class="line">          icon: <span class="string">&#x27;form&#x27;</span>,</span><br><span class="line">          noCache: <span class="literal">false</span> <span class="comment">// 如果设置为true，则不会被 &lt;keep-alive&gt; 缓存(默认 false)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ....</span><br><span class="line">  <span class="comment">// 404 page must be placed at the end !!!</span></span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&#x27;*&#x27;</span>, <span class="attr">redirect</span>: <span class="string">&#x27;/404&#x27;</span>, <span class="attr">hidden</span>: <span class="literal">true</span> &#125;</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> createRouter = <span class="function">() =&gt;</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span>, <span class="comment">// require service support</span></span><br><span class="line">  scrollBehavior: <span class="function">() =&gt;</span> (&#123; <span class="attr">y</span>: <span class="number">0</span> &#125;),</span><br><span class="line">  routes: constantRoutes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = createRouter()</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">resetRouter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> newRouter = createRouter()</span><br><span class="line">  router.matcher = newRouter.matcher <span class="comment">// reset router</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="src-store-modules-user-js-用户登陆获取数据"><a href="#src-store-modules-user-js-用户登陆获取数据" class="headerlink" title="src/store/modules/user.js 用户登陆获取数据"></a>src/store/modules/user.js 用户登陆获取数据</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  正常流程是在login接口获取到 token，存在vuex中 供登陆</span></span><br><span class="line"><span class="comment">  然后在getInfo接口获取到 路由和用户信息 存储并发送出去 供路由的动态配置</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  但是 我们这个项目把getInfo接口取消了 在login接口就直接获取到路由信息</span></span><br><span class="line"><span class="comment">  本来是不需要自己封装info数据的</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// user login</span></span><br><span class="line">  login(&#123;commit&#125;, userInfo) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; username,password &#125; = userInfo</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      login(&#123; <span class="attr">account</span>: username.trim(), <span class="attr">password</span>: password &#125;).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">          data</span><br><span class="line">        &#125; = response</span><br><span class="line">        <span class="comment">// 存储到cookie中 ！很重要 不然登陆不了 接口在 src/utils/auth.js</span></span><br><span class="line">        setToken(&#123; <span class="attr">username</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;admin&#x27;</span> &#125;)  </span><br><span class="line">        <span class="keyword">var</span> info = &#123; <span class="attr">username</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="attr">roles</span>: [<span class="string">&#x27;admin&#x27;</span>], <span class="attr">routes</span>: data.permission &#125; </span><br><span class="line">         commit(<span class="string">&#x27;SET_TOKEN&#x27;</span>, info)  <span class="comment">// 存储到 vuex 中 数据格式如上 ↑ </span></span><br><span class="line">        resolve()</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        reject(error)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  getInfo(&#123; commit,state &#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 可以把这三个写在 info 中 从info里获取</span></span><br><span class="line">      <span class="keyword">const</span> roles = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">      <span class="keyword">const</span> name = <span class="string">&#x27;Super Admin&#x27;</span></span><br><span class="line">      <span class="keyword">const</span> avatar = <span class="string">&#x27;http://pic.51yuansu.com/pic3/cover/03/47/85/5badd30d6526d_610.jpg&#x27;</span></span><br><span class="line">      commit(<span class="string">&#x27;SET_ROLES&#x27;</span>, roles)</span><br><span class="line">      commit(<span class="string">&#x27;SET_NAME&#x27;</span>, name)</span><br><span class="line">      commit(<span class="string">&#x27;SET_AVATAR&#x27;</span>, avatar) <span class="comment">// 存储在cookie中</span></span><br><span class="line">      resolve(state.token)  <span class="comment">// 发送 info 值 ，传递给 permission</span></span><br><span class="line">     &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// get user info 如果是有info接口的传递方法</span></span><br><span class="line">  <span class="comment">/* getInfo(&#123; commit, state &#125;) &#123;</span></span><br><span class="line"><span class="comment">    return new Promise((resolve, reject) =&gt; &#123;</span></span><br><span class="line"><span class="comment">      getInfo(state.token).then(response =&gt; &#123;</span></span><br><span class="line"><span class="comment">        const &#123; data &#125; = response</span></span><br><span class="line"><span class="comment">        if (!data) &#123;</span></span><br><span class="line"><span class="comment">          reject(&#x27;Verification failed, please Login again.&#x27;)</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        const &#123; roles, name, avatar &#125; = data</span></span><br><span class="line"><span class="comment">        // roles must be a non-empty array</span></span><br><span class="line"><span class="comment">        if (!roles || roles.length &lt;= 0) &#123;</span></span><br><span class="line"><span class="comment">          reject(&#x27;getInfo: roles must be a non-null array!&#x27;)</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        commit(&#x27;SET_ROLES&#x27;, roles)</span></span><br><span class="line"><span class="comment">        commit(&#x27;SET_NAME&#x27;, name)</span></span><br><span class="line"><span class="comment">        commit(&#x27;SET_AVATAR&#x27;, avatar)</span></span><br><span class="line"><span class="comment">        console.log(data)</span></span><br><span class="line"><span class="comment">        resolve(data)</span></span><br><span class="line"><span class="comment">      &#125;).catch(error =&gt; &#123;</span></span><br><span class="line"><span class="comment">        reject(error)</span></span><br><span class="line"><span class="comment">      &#125;)</span></span><br><span class="line"><span class="comment">    &#125;)</span></span><br><span class="line"><span class="comment">  &#125;, */</span></span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  namespaced: <span class="literal">true</span>,</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="src-store-modules-permission-js-权限获取"><a href="#src-store-modules-permission-js-权限获取" class="headerlink" title="src/store/modules/permission.js 权限获取"></a>src/store/modules/permission.js 权限获取</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  本来是根据角色roles权限过滤路由,并显示到侧边栏</span></span><br><span class="line"><span class="comment">  roles.</span></span><br><span class="line"><span class="comment">  但是现在是不根据权限 而是后台传递的路由信息 所以不用判断权限 修改为</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  generateRoutes(&#123; commit &#125;, userinfo) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">const</span> strRoutes = <span class="built_in">JSON</span>.stringify(userinfo.routes)</span><br><span class="line">       <span class="keyword">const</span> accessedRoutes = filterAsyncRoutes(asyncRoutes, strRoutes) <span class="comment">//路由的过滤器 获取相同的路由</span></span><br><span class="line">      commit(<span class="string">&#x27;SET_ROUTES&#x27;</span>, accessedRoutes)</span><br><span class="line">      resolve(accessedRoutes)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="src-permission-js-用户信息传递-amp-配置路由"><a href="#src-permission-js-用户信息传递-amp-配置路由" class="headerlink" title="src/permission.js 用户信息传递&amp;配置路由"></a>src/permission.js 用户信息传递&amp;配置路由</h3><blockquote>
<p>首先确定userinfo需要的格式  就是getInfo函数传递过来的 resolve(state.token)</p>
</blockquote>
<p>path对应的是路由中的permission<br><img src='/images/数据格式.png' >  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">router.beforeEach(<span class="keyword">async</span>(to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (hasToken) &#123;</span><br><span class="line">    <span class="keyword">if</span> (to.path === <span class="string">&#x27;/login&#x27;</span>) &#123;</span><br><span class="line">     ...</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// determine whether the user has obtained his permission roles through getInfo</span></span><br><span class="line">      <span class="keyword">const</span> hasRoles = store.getters.roles &amp;&amp; store.getters.roles.length &gt; <span class="number">0</span></span><br><span class="line">      <span class="keyword">if</span> (hasRoles) &#123;</span><br><span class="line">        next()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 登录后会走这里获取roles</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">// get user info</span></span><br><span class="line">          <span class="comment">// note: roles must be a object array! such as: [&#x27;admin&#x27;] or ,[&#x27;developer&#x27;,&#x27;editor&#x27;]</span></span><br><span class="line">          <span class="keyword">const</span> userinfo = <span class="keyword">await</span> store.dispatch(<span class="string">&#x27;user/getInfo&#x27;</span>) <span class="comment">//获取用户信息</span></span><br><span class="line">          <span class="comment">// 调用store下module下的permission文件中的generateRoutes方法</span></span><br><span class="line">          <span class="keyword">const</span> accessRoutes = <span class="keyword">await</span> store.dispatch(<span class="string">&#x27;permission/generateRoutes&#x27;</span>, userinfo) <span class="comment">// 获取动态路由</span></span><br><span class="line">          <span class="comment">// dynamically add accessible routes 显示获取到的侧边栏</span></span><br><span class="line">          router.addRoutes(accessRoutes)  <span class="comment">//创建路由</span></span><br><span class="line"></span><br><span class="line">          next(&#123; ...to, <span class="attr">replace</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">          ...</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="被遗漏的BUG"><a href="#被遗漏的BUG" class="headerlink" title="被遗漏的BUG"></a>被遗漏的BUG</h3><blockquote>
<p>描述： 登录完成之后，进入操作页面 刷新 又需要重新登录  </p>
</blockquote>
<p>原因： 之前这个模板是调用的getInfo接口获取、存储路由信息<br>页面刷新之后 再次调用接口即可获取到路由等信息  </p>
<p>但是我们把getInfo接口废弃了 路由信息是登陆的时候获取<br>存在vuex中 在getInfo函数内直接使用的vuex存储的数据 并发布出去  </p>
<p><b style='color:red'>原因就在于 vuex刷新之后 数据就清空了！所以又需要重新登录 获取路由等信息。 </b>   </p>
<blockquote>
<p>解决:<br>在login登陆接口之后获取到路由数据<br>通过sessionStorage / localStorage 存放在本地<br>然后在使用 getInfo 函数的时候 不从vuex内获取 从 sessionStorage / localStorage 获取并发送    </p>
</blockquote>
<p>注意：在退出登陆的时候 即调用logout接口之前要通过.removeItem()进行删除操作 不然不能正常退出登陆</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-options请求和axios跨域及cookie传递问题"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/01/01/options%E8%AF%B7%E6%B1%82%E5%92%8Caxios%E8%B7%A8%E5%9F%9F%E5%8F%8Acookie%E4%BC%A0%E9%80%92%E9%97%AE%E9%A2%98/"
    >options请求和axios跨域及cookie传递问题</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/01/01/options%E8%AF%B7%E6%B1%82%E5%92%8Caxios%E8%B7%A8%E5%9F%9F%E5%8F%8Acookie%E4%BC%A0%E9%80%92%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2020-01-01T02:00:00.000Z" itemprop="datePublished">2020-01-01</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/bug%E6%94%B6%E9%9B%86%E7%AB%99/">bug收集站</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <blockquote>
<p>options请求： 检测请求的接口的信息（服务器接受的方法、跨域中测实际请求是否可以被服务器所接受）</p>
</blockquote>
<h3 id="什么情况下会发送options预检请求"><a href="#什么情况下会发送options预检请求" class="headerlink" title="什么情况下会发送options预检请求"></a>什么情况下会发送options预检请求</h3><blockquote>
<p>浏览器将CORS请求分为两类：简单请求、非简单请求</p>
</blockquote>
<ul>
<li><p>简单请求（不会发送预检请求）与非简单请求（请求之前发送options）的区别</p>
<ol>
<li><p>请求方法：get、post、head</p>
</li>
<li><p>http请求头信息：<br>accept<br>accept-language、<br>content-language、<br>content-type、<br>last-event-id  </p>
</li>
<li><p>content-type：<br>application/x-www-form-urlencoded、<br>multipart/form-data、<br>text/plain</p>
<blockquote>
<p>同时满足以上两个条件时，才是简单请求，否则为非简单请求</p>
</blockquote>
</li>
</ol>
</li>
</ul>
<h3 id="axios跨域并获取cookie"><a href="#axios跨域并获取cookie" class="headerlink" title="axios跨域并获取cookie"></a>axios跨域并获取cookie</h3><p>  <a target="_blank" rel="noopener" href="http://www.axios-js.com/zh-cn/docs/">axios详细配置文档</a></p>
<blockquote>
<p>核心：<br>1.axios全局配置中添加  withCredentials: true 跨域并保存cookie<br>2.在请求拦截器内设置 content-type：application/json  </p>
</blockquote>
<p>  不是很理解第二点 加了之后不是把所有请求都变成非简单请求了吗<br>  但是不加的话就报错了<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; MessageBox, Message &#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create an axios instance</span></span><br><span class="line">axios.defaults.headers.common[<span class="string">&#x27;X-Requested-With&#x27;</span>] = <span class="string">&#x27;XMLHttpRequest&#x27;</span> <span class="comment">// ！ 可能是非必须 </span></span><br><span class="line">  <span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">  baseURL: process.env.VUE_APP_BASE_API, <span class="comment">// url = base url + request url</span></span><br><span class="line">  withCredentials: <span class="literal">true</span>, <span class="comment">// send cookies when cross-domain requests</span></span><br><span class="line">  timeout: <span class="number">5000</span> <span class="comment">// request timeout</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// request interceptor 请求拦截</span></span><br><span class="line">service.interceptors.request.use(</span><br><span class="line">  config =&gt; &#123;</span><br><span class="line">    config.headers = &#123;</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> <span class="comment">//  注意：设置很关键</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    <span class="comment">// do something with request error</span></span><br><span class="line">    <span class="built_in">console</span>.log(error) <span class="comment">// for debug</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>  后端相应的配置：<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span>,<span class="keyword">true</span>); <span class="comment">// 必须加上</span></span><br><span class="line">response.setHeader(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="string">&#x27;http://localhost:9528&#x27;</span>);   <span class="comment">//不能写成 * ，一定要指定地址</span></span><br><span class="line">response.setHeader(<span class="string">&#x27;Set-Cookie&#x27;</span>,<span class="string">&#x27;token=cowshield&#x27;</span>); <span class="comment">//传递的数据</span></span><br></pre></td></tr></table></figure></p>
<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>  按理说应该是可以了<br>  但是后台说因为有options预检请求<br>  所以请求会有两次 但是他能获取的是options那次 后面那个请求获取不到<br>  但是options请求又没有能保存传递的数据 导致一些问题  </p>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>  我觉得不严谨 但是有效<br>  大概是 写了一个拦截器 对于options请求直接返回true 就可以进入下一个请求了  </p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p>  <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/04/cors.html">http://www.ruanyifeng.com/blog/2016/04/cors.html</a><br>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_25551573/article/details/80690583">https://blog.csdn.net/qq_25551573/article/details/80690583</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-2019年总结"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/12/31/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"
    >2019年度总结</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/12/31/2019%E5%B9%B4%E6%80%BB%E7%BB%93/" class="article-date">
  <time datetime="2019-12-31T02:21:42.000Z" itemprop="datePublished">2019-12-31</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/">年度总结</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <pre>
关键词：忙碌、压抑

今年可以说是压力最大的一年  比我高考压力还大
上半年基本一直在学前端相关的东西 积累项目经验
刚好在项目实训的时候也用上了 之前一直操心的实训算是轻松顺利完成

下半年一直在准备秋招相关的东西  边面试边查漏补缺
这两个学期我和考研党一样 早出晚归 基本天天呆在教室

秋招这几个月 是我迄今为止度过的最黑暗的日子
激动，希望，失望，自我怀疑，放弃 各种感情都经历过了
但也好在自己的坚持和努力 在秋招快结束的时候稀里糊涂的找了一份对我来说还不错的工作（七月份过了体检才能正式入职，感觉还是没底）
毕设这边虽然中途出现了一个小bug，但也解决了，开题也挺顺利的 希望明年能顺利毕业

十一月底学校的事情处理完，三方流程走完就马不停蹄的找了份实习
一个人拖着行李来到长沙 
目前是我实习刚好一个月，和我想象的不太一样，
干满三个月就不想干了，感觉在浪费时间，没有我自学学的多

大学生活也差不多快结束了 
讲真这段日子没什么可以留恋的
简直是糟透了的日子
唯一教会我的是如何习惯孤独
以前连上厕所都要拉着人去的我
现在已经习惯一个人吃饭，上课，自习，逛超市。。。

有时想想也觉得自己挺可怜的
不知道从什么时候开始  我好像也成了别人眼中的异类
我也不是不合群啊 只是好像适应不了这种快节奏的交友模式
不知道怎么融入 也没有机会融入

行吧 也不奢求太多
只希望2020年 工作和学习能顺顺利利
我可能没有那么强大的内心再来一次了
</pre>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-CSS相关"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/12/30/CSS%E7%9B%B8%E5%85%B3/"
    >CSS相关</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/12/30/CSS%E7%9B%B8%E5%85%B3/" class="article-date">
  <time datetime="2019-12-30T02:21:42.000Z" itemprop="datePublished">2019-12-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/CSS/">CSS</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <blockquote>
<p>想闲暇的时候学点CSS动画的实现方法，<br>希望能持续更新 见证自己的成长 ，实现的效果也能越来越复杂好看！</p>
</blockquote>
<h1 id="波纹效果"><a href="#波纹效果" class="headerlink" title="波纹效果"></a>波纹效果</h1><style>
.coverBox{
    width: 500px;
    height: 500px;
    border: 1px solid black;
    display: flex;
    justify-content: center;
    align-items: center;
    background: black
}
.coverBox .box{
    position: relative;
    width: 200px;
    height: 300px;
    border: 1px solid black;
    overflow: hidden;
    background: linear-gradient(#5f2c82,#49a09d);
}
.coverBox .box .box-bg{
    width: 100%;
    background: white;
    animation: bg-color 6s ease-out infinite;
}
.coverBox .box .wave{
    position: absolute;
    top: -100px;
    left: 50%;
    margin-left: -125px;
    width: 250px;
    height: 250px;
    background: white;
    border-radius: 45% 38% 35% 44%;
    animation: wave3 6s linear infinite;
}
.coverBox .box .wave1{
    background: rgba(255,255,255,0.8);
    transform: translate(15px);
    animation: wave1 6s linear infinite;
}
.coverBox .box .wave2{
    background: rgba(255,255,255,0.5);
    transform: translate(-15px);
    animation: wave2 6s linear infinite;
}
@keyframes bg-color {
    from{
        height: 100%
    }to{
        height: 0;
    }
}
@keyframes wave1 {
    0%{
        transform: translate(0,150px);
        border-radius: 46% 38% 44% 57%;
    }50%{
        border-radius: 33% 50% 66% 47%;
    }
    100%{
        transform: translate(15px,0px) rotate(135deg);
    } 
}
@keyframes wave2 {
    from{
        transform: translate(0,150px);
        border-radius: 46% 48% 34% 37%;
    }
    to{
        transform:translate(-15px,0px) rotate(-135deg);
    } 
}
@keyframes wave3 {
    from{
        transform: translate(0,150px);
        border-radius: 66% 38% 44% 47%;

    }to{
        transform: rotate(135deg) translate(0,0px);
    } 
}
</style>
<div class="coverBox">
    <div class="box">
        <div class="wave wave1"></div>
        <div class="wave wave2"></div>
        <div class="wave wave3"></div>
        <div class="box-bg"></div>
    </div>
</div>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSS-Wave<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-class">.cover</span>&#123;</span></span><br><span class="line">    width: 500px;</span><br><span class="line">    height: 500px;</span><br><span class="line">    border: 1px solid black;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.cover</span> <span class="selector-class">.box</span>&#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 300px;</span><br><span class="line">    border: 1px solid black;</span><br><span class="line">    overflow: hidden;</span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-tag">linear-gradient</span>(<span class="selector-id">#5f2c82</span>,<span class="selector-id">#49a09d</span>);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.cover</span> <span class="selector-class">.box-bg</span>&#123;</span></span><br><span class="line">    width: 100%;</span><br><span class="line">    background: white;</span><br><span class="line">    animation: bg-color 6s ease-out infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.cover</span> <span class="selector-class">.wave</span>&#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: -100px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    margin-left: -125px;</span><br><span class="line">    width: 250px;</span><br><span class="line">    height: 250px;</span><br><span class="line">    background: white;</span><br><span class="line">    border-radius: 45% 38% 35% 44%;</span><br><span class="line">    animation: wave3 6s linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.cover</span> <span class="selector-class">.wave1</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-tag">rgba</span>(255,255,255,0<span class="selector-class">.8</span>);</span></span><br><span class="line">    transform: translate(15px);</span><br><span class="line">    animation: wave1 6s linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.cover</span> <span class="selector-class">.wave2</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-tag">rgba</span>(255,255,255,0<span class="selector-class">.5</span>);</span></span><br><span class="line">    transform: translate(-15px);</span><br><span class="line">    animation: wave2 6s linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> bg-color &#123;</span></span><br><span class="line">    from&#123;</span><br><span class="line">        height: 100%</span><br><span class="line">    &#125;to&#123;</span><br><span class="line">        height: 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> wave1 &#123;</span></span><br><span class="line">    0%&#123;</span><br><span class="line">        transform: translate(0,150px);</span><br><span class="line">        border-radius: 46% 38% 44% 57%;</span><br><span class="line">    &#125;50%&#123;</span><br><span class="line">        border-radius: 33% 50% 66% 47%;</span><br><span class="line">    &#125;</span><br><span class="line">    100%&#123;</span><br><span class="line">        transform: translate(15px,0px) rotate(135deg);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> wave2 &#123;</span></span><br><span class="line">    from&#123;</span><br><span class="line">        transform: translate(0,150px);</span><br><span class="line">        border-radius: 46% 48% 34% 37%;</span><br><span class="line">    &#125;</span><br><span class="line">    to&#123;</span><br><span class="line"><span class="css">        <span class="selector-tag">transform</span><span class="selector-pseudo">:translate(-15px</span>,0<span class="selector-tag">px</span>) <span class="selector-tag">rotate</span>(<span class="selector-tag">-135deg</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> wave3 &#123;</span></span><br><span class="line">    from&#123;</span><br><span class="line">        transform: translate(0,150px);</span><br><span class="line">        border-radius: 66% 38% 44% 47%;</span><br><span class="line">        </span><br><span class="line">    &#125;to&#123;</span><br><span class="line">        transform: rotate(135deg) translate(0,0px);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wave wave1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wave wave2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wave wave3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box-bg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="充电动画"><a href="#充电动画" class="headerlink" title="充电动画"></a>充电动画</h1><blockquote>
<p>核心原理 filter的两个属性 blur（高斯模糊）px、contrast（对比度）%、hue-rotate(色相旋转) deg<br>有个疑问 就是w3c里面查的contrast的单位应该是 % 这个例子里面如果给它加了单位就实现不了了 就直接改变整体的对比度<br>blur(px): 默认为0，数值越大越模糊<br>contrast(%): 0%全黑，100%图像无变化。默认为1，超过100%图像会比原来亮<br>hue-rotate(deg)：0deg图像无变化。默认是0deg。该值虽然没有最大值，超过360deg的值相当于又绕一圈。<br><b style='color:red'>Tips:<br>背景一般选择黑色或者白色，不然会受到contrast和hue-rotate的影响<br>在实现渐变效果的时候 filter: contrast(20) hue-rotate(0deg); 顺序不能变<br></b></p>
</blockquote>
<style>
  /*外层盒子不设置 对比度*/
  .css-box .test,.test1,.test2,.test3{
    width: 100px;
    height: 100px;
    background: black;
    position: relative;
  }
  .css-box .test::before {
    content: " ";
    width: 50px;
    height: 50px;
    filter: blur(15px);
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    margin: auto;
    background: white;
    position: absolute;
  }
  /*外层盒子设置 对比度*/
  .css-box .test1 { 
    filter: contrast(20);
  }
  .css-box .test1::before {
    content: " ";
    width: 50px;
    height: 50px;
    filter: blur(15px);
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    margin: auto;
    background: white;
    position: absolute;
  }
  /* 内部盒子相遇时*/
  .css-box .test2 {
    filter: contrast(20);
  }
  .css-box .test2::before {
    content: " ";
    width: 50px;
    height: 50px;
    filter: blur(5px);
    left: 50%;
    top: 50%;
    border-radius: 50%;
    margin-left: -25px;
    margin-top: -25px;
    background: white;
    position: absolute;
  }
  .css-box .test2::after {
    content: " ";
    width: 20px;
    height: 20px;
    border-radius: 50%;
    filter: blur(5px);
    left: 50%;
    top: 50%;
    margin-left: -40px;
    margin-top: -10px;
    background: red;
    position: absolute;
  }
  /*内部盒子运动+渐变颜色*/
  /* filter: contrast(20) hue-rotate(0deg); 顺序不能变*/
  .css-box .test3 {
    filter: contrast(20) hue-rotate(0deg);
    animation: changeColor 5s linear infinite
  }
  @keyframes changeColor {
    100% {
      filter: contrast(20) hue-rotate(360deg);
    }
  }
  .css-box .test3::before {
    content: " ";
    width: 50px;
    height: 50px;
    filter: blur(5px);
    left: 50%;
    top: 50%;
    border-radius: 50%;
    margin-left: -25px;
    margin-top: -25px;
    background: rgb(201, 93, 93);
    position: absolute;
    animation: bigBallMove 2s linear infinite
  }
  .css-box .test3::after {
    content: " ";
    width: 20px;
    height: 20px;
    border-radius: 50%;
    filter: blur(5px);
    left: 50%;
    top: 50%;
    margin-left: -40px;
    margin-top: -10px;
    background: rgb(201, 93, 93);
    position: absolute;
    animation: ballMove 2s linear infinite;
  }
  @keyframes ballMove {
    100% {
      transform: translateX(70px);
    }
  }
  @keyframes bigBallMove {
    100% {
      transform: translateX(-20px);
    }
  }
  .css-box{
    width: 200px;
    height: 200px;
    border: 1px solid #ccc;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }
</style>

  <div class="css-box">
    内部设置高斯模糊 外层盒子不设置 对比度
    <div class="test"></div>
  </div>
  <div class="css-box">
    外层盒子设置 对比度 <br>
    （好像是在视觉上抵消内部盒子的高斯模糊）
    <div class="test1"></div>
  </div>
  <div class="css-box">
    内部盒子相遇时
    <div class="test2"></div>
  </div>
  <div class="css-box">
    内部盒子运动+渐变颜色<br>
    （filter: contrast(20) hue-rotate(0deg); 顺序不能变！！！）
    <div class="test3"></div>
  </div>

<style>
  /* 黑幕布 */
  .filter-mix {
    width: 300px;
    height: 350px;
    filter: contrast(20) hue-rotate(0deg);
    background: black;
    animation: bgChange 4s linear infinite;
    overflow: hidden;
    border: none;
  }
  @keyframes bgChange {
    100% {
      filter: contrast(20) hue-rotate(360deg);
    }
  }
  /* 外圈区域 */
  .filter-mix .box,
  .filter-mix::before {
    content: "";
    position: absolute;
    width: 130px;
    height: 130px;
    left: 50%;
    top: 60px;
    margin-left: -65px;
    border-radius: 50% 35% 66% 47%;
    background: #0ABFBC;
    z-index: 2;
    filter: blur(6px) hue-rotate(0deg);
    box-sizing: border-box;
    animation: filterBallMove 4s linear infinite;
  }
  .filter-mix .box1 {
    border-radius: 35% 22% 67% 44%;
    animation: filterBallMove1 4s linear infinite;
  }
  .filter-mix .box2 {
    border-radius: 55% 42% 37% 44%;
    animation: filterBallMove 4s linear infinite;
  }
  @keyframes filterBallMove {
    100% {
      transform: rotate(-360deg);
    }
  }
  @keyframes filterBallMove1 {
    100% {
      transform: rotate(360deg);
    }
  }
  /* 内部区域 */
  .filter-mix::after {
    content: "";
    position: absolute;
    width: 120px;
    height: 120px;
    left: 50%;
    top: 65px;
    margin-left: -60px;
    border-radius: 50% 48% 54% 45%;
    background: black;
    z-index: 2;
    filter: blur(6px);
    animation: filterBallMove2 4s linear infinite;
  }
  @keyframes filterBallMove2 {
    100% {
      transform: rotate(360deg);
    }
  }
  /* 中心文字 */
  .filter-mix .text {
    position: absolute;
    color: white;
    width: 50px;
    height: 50px;
    text-align: center;
    line-height: 50px;
    font-size: 30px;
    left: 50%;
    top: 95px;
    margin-left: -25px;
    z-index: 10;
  }
  /* 下方的泡泡 */
  .filter-mix .pop {
    position: absolute;
    width: 25px;
    height: 25px;
    background: #0ABFBC;
    border-radius: 50%;
    filter: blur(6px);
  }
  .filter-mix :nth-child(8) {
    bottom: 30px;
    left: 50%;
    margin-left: -12.5px;
    animation: popMove 4s linear infinite;
  }
  .filter-mix :nth-child(10) {
    bottom: 30px;
    left: 50%;
    margin-left: -10px;
    animation: popMove 4s 2s linear infinite;
  }
  .filter-mix :nth-child(12) {
    bottom: 30px;
    left: 50%;
    animation: popMove 5s linear infinite;
  }
  .filter-mix :nth-child(14) {
    bottom: 40px;
    left: 40%;
    margin-left: -12.5px;
    animation: popMove 3s 1s linear infinite;
  }
  .filter-mix :nth-child(16) {
    bottom: 30px;
    left: 50%;
    margin-left: 5px;
    animation: popMove 7s linear infinite;
  }
  /* 底部基座 */
  .filter-mix .bottomPop {
    background: #0ABFBC;
    position: absolute;
    width: 100px;
    height: 40px;
    left: 50%;
    bottom: -5px;
    margin-left: -50px;
    filter: blur(6px);
    border-radius: 100px 100px 0 0;
  }
  @keyframes popMove {
    100% {
      transform: translateY(-120px);
    }
  }
</style>
<p>  成品效果：<br>  <div class="filter-mix"><br>    <div class="box box1"></div><br>    <div class="box box2"></div><br>    <div class="text">9%</div><br>    <div class="pop"></div><br>    <div class="pop"></div><br>    <div class="pop"></div><br>    <div class="pop"></div><br>    <div class="pop"></div><br>    <div class="bottomPop"></div><br>  </div></p>
<p>代码实现：<br>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="comment">/*外层盒子不设置 对比度*/</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.test</span> &#123;</span></span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    background: black;</span><br><span class="line">    position: relative;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.test</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    filter: blur(15px);</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    margin: auto;</span><br><span class="line">    background: white;</span><br><span class="line">    position: absolute;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/*外层盒子设置 对比度*/</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.test1</span> &#123;</span></span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    background: black;</span><br><span class="line">    filter: contrast(20);</span><br><span class="line">    position: relative;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.test1</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    filter: blur(15px);</span><br><span class="line">    left: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    margin: auto;</span><br><span class="line">    background: white;</span><br><span class="line">    position: absolute;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/* 内部盒子相遇时*/</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.test2</span> &#123;</span></span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    background: black;</span><br><span class="line">    filter: contrast(20);</span><br><span class="line">    position: relative;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.test2</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    filter: blur(5px);</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 50%;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    margin-left: -25px;</span><br><span class="line">    margin-top: -25px;</span><br><span class="line">    background: white;</span><br><span class="line">    position: absolute;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.test2</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    filter: blur(5px);</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 50%;</span><br><span class="line">    margin-left: -40px;</span><br><span class="line">    margin-top: -10px;</span><br><span class="line">    background: red;</span><br><span class="line">    position: absolute;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/*内部盒子运动+渐变颜色*/</span></span></span><br><span class="line"><span class="css">  <span class="comment">/* filter: contrast(20) hue-rotate(0deg); 顺序不能变*/</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.test3</span> &#123;</span></span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    background: black;</span><br><span class="line">    filter: contrast(20) hue-rotate(0deg);</span><br><span class="line">    position: relative;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span></span><br><span class="line">    animation: changeColor 5s linear infinite</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> changeColor &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      filter: contrast(20) hue-rotate(360deg);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.test3</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    filter: blur(5px);</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 50%;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    margin-left: -25px;</span><br><span class="line">    margin-top: -25px;</span><br><span class="line">    background: rgb(201, 93, 93);</span><br><span class="line">    position: absolute;</span><br><span class="line">    animation: bigBallMove 2s linear infinite</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.test3</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line">    content: &quot; &quot;;</span><br><span class="line">    width: 20px;</span><br><span class="line">    height: 20px;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    filter: blur(5px);</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 50%;</span><br><span class="line">    margin-left: -40px;</span><br><span class="line">    margin-top: -10px;</span><br><span class="line">    background: rgb(201, 93, 93);</span><br><span class="line">    position: absolute;</span><br><span class="line">    animation: ballMove 2s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> ballMove &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      transform: translateX(70px);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> bigBallMove &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      transform: translateX(-20px);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.css-box</span>&#123;</span></span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 200px;</span><br><span class="line"><span class="css">    <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span></span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    display: inline-block;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">   <span class="comment">/* 黑幕布 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 50%;</span><br><span class="line">    left: 50%;</span><br><span class="line">    transform: translate(-50%, -50%);</span><br><span class="line">    width: 300px;</span><br><span class="line">    height: 350px;</span><br><span class="line">    filter: contrast(20) hue-rotate(0deg);</span><br><span class="line">    background: black;</span><br><span class="line">    animation: bgChange 4s linear infinite;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    border: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> bgChange &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      filter: contrast(20) hue-rotate(360deg);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/* 外圈区域 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.box</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &quot;&quot;;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 130px;</span><br><span class="line">    height: 130px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 60px;</span><br><span class="line">    margin-left: -65px;</span><br><span class="line">    border-radius: 50% 35% 66% 47%;</span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#0ABFBC</span>;</span></span><br><span class="line">    z-index: 2;</span><br><span class="line">    filter: blur(6px) hue-rotate(0deg);</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    animation: filterBallMove 4s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.box1</span> &#123;</span></span><br><span class="line">    border-radius: 35% 22% 67% 44%;</span><br><span class="line">    animation: filterBallMove1 4s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.box2</span> &#123;</span></span><br><span class="line">    border-radius: 55% 42% 37% 44%;</span><br><span class="line">    animation: filterBallMove 4s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> filterBallMove &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      transform: rotate(-360deg);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> filterBallMove1 &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      transform: rotate(360deg);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/* 内部区域 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line">    content: &quot;&quot;;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 120px;</span><br><span class="line">    height: 120px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 65px;</span><br><span class="line">    margin-left: -60px;</span><br><span class="line">    border-radius: 50% 48% 54% 45%;</span><br><span class="line">    background: black;</span><br><span class="line">    z-index: 2;</span><br><span class="line">    filter: blur(6px);</span><br><span class="line">    animation: filterBallMove2 4s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> filterBallMove2 &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      transform: rotate(360deg);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/* 中心文字 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span> <span class="selector-class">.text</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    color: white;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 50px;</span><br><span class="line">    font-size: 30px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    top: 95px;</span><br><span class="line">    margin-left: -25px;</span><br><span class="line">    z-index: 10;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/* 下放的泡泡 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.pop</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 25px;</span><br><span class="line">    height: 25px;</span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#0ABFBC</span>;</span></span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    filter: blur(6px);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span> <span class="selector-pseudo">:nth-child(4)</span> &#123;</span></span><br><span class="line">    bottom: 30px;</span><br><span class="line">    left: 50%;</span><br><span class="line"><span class="css">    <span class="selector-tag">margin-left</span>: <span class="selector-tag">-12</span><span class="selector-class">.5px</span>;</span></span><br><span class="line">    animation: popMove 4s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span> <span class="selector-pseudo">:nth-child(5)</span> &#123;</span></span><br><span class="line">    bottom: 30px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    margin-left: -10px;</span><br><span class="line">    animation: popMove 4s 2s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span> <span class="selector-pseudo">:nth-child(6)</span> &#123;</span></span><br><span class="line">    bottom: 30px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    animation: popMove 5s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span> <span class="selector-pseudo">:nth-child(7)</span> &#123;</span></span><br><span class="line">    bottom: 40px;</span><br><span class="line">    left: 40%;</span><br><span class="line"><span class="css">    <span class="selector-tag">margin-left</span>: <span class="selector-tag">-12</span><span class="selector-class">.5px</span>;</span></span><br><span class="line">    animation: popMove 3s 1s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.filter-mix</span> <span class="selector-pseudo">:nth-child(8)</span> &#123;</span></span><br><span class="line">    bottom: 30px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    margin-left: 5px;</span><br><span class="line">    animation: popMove 7s linear infinite;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="comment">/* 底部基座 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.bottomPop</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#0ABFBC</span>;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    left: 50%;</span><br><span class="line">    bottom: -5px;</span><br><span class="line">    margin-left: -50px;</span><br><span class="line">    filter: blur(6px);</span><br><span class="line">    border-radius: 100px 100px 0 0;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> popMove &#123;</span></span><br><span class="line">    100% &#123;</span><br><span class="line">      transform: translateY(-120px);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;css-box&quot;</span>&gt;</span></span><br><span class="line">    外层盒子不设置 对比度</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;css-box&quot;</span>&gt;</span></span><br><span class="line">    外层盒子设置 对比度</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;test1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;css-box&quot;</span>&gt;</span></span><br><span class="line">    内部盒子相遇时</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;test2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;css-box&quot;</span>&gt;</span></span><br><span class="line">    内部盒子运动+渐变颜色</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;test3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;filter-mix&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box box1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box box2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>99%<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pop &quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pop&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pop&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pop&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pop&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bottomPop&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-第六章__代理模式"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/12/28/%E7%AC%AC%E5%85%AD%E7%AB%A0__%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"
    >【第六章】代理模式</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/12/28/%E7%AC%AC%E5%85%AD%E7%AB%A0__%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time datetime="2019-12-28T15:00:00.000Z" itemprop="datePublished">2019-12-28</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <blockquote>
<p>定义: 为一个对象提供一个代用品或占位符，以控制对它的访问<br>关键：当客户不方便直接访问一个对象或者不满足需求的时候，提供一个替身对象来控制对这个对象的访问，客户实际上访问的是替身对象。替身对象对请求作出一些处理之后，再把请求转交给本体对象  </p>
</blockquote>
<p>不使用代理模式：  客户 ——&gt;  本体<br>使用代理模式：    客户 ——&gt;  代理  ——&gt;  本体</p>
<h2 id="一个解释代理模式的例子"><a href="#一个解释代理模式的例子" class="headerlink" title="一个解释代理模式的例子"></a>一个解释代理模式的例子</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">M  直接送花给 A</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> Flower = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> M = &#123;</span><br><span class="line">    sendFlower: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> flower = <span class="keyword">new</span> Flower()</span><br><span class="line">        target.receiveFlower(flower)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> A = &#123;</span><br><span class="line">    receiveFlower: <span class="function"><span class="keyword">function</span>(<span class="params">flower</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;收到花&#x27;</span>+flower)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">M.sendFlower(A)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">M 通过 B 送花给 A</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> Flower = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> M = &#123;</span><br><span class="line">    sendFlower: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> flower = <span class="keyword">new</span> Flower()</span><br><span class="line">        target.receiveFlower(flower)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> B = &#123;</span><br><span class="line">    receiveFlower: <span class="function"><span class="keyword">function</span>(<span class="params">flower</span>)</span>&#123;</span><br><span class="line">        A.receiveFlower(flower)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> A = &#123;</span><br><span class="line">    receiveFlower: <span class="function"><span class="keyword">function</span>(<span class="params">flower</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;收到花&#x27;</span>+flower)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">M.sendFlower(B)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">现在我们改变故事的背景设定，假设当 A 在心情好的时候收到花，小明表白成功的几率有60%，而当 A 在心情差的时候收到花，小明表白的成功率无限趋近于 0。</span></span><br><span class="line"><span class="comment">小明跟 A 刚刚认识两天，还无法辨别 A 什么时候心情好。如果不合时宜地把花送给 A，花被直接扔掉的可能性很大</span></span><br><span class="line"><span class="comment">但是 A 的朋友 B 却很了解 A，所以小明只管把花交给 B，B 会监听 A 的心情变化，然后选择 A 心情好的时候把花转交给 A，</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> Flower = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> M = &#123;</span><br><span class="line">sendFlower: <span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> flower = <span class="keyword">new</span> Flower()</span><br><span class="line">    target.receiveFlower(flower)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> B = &#123;</span><br><span class="line">receiveFlower: <span class="function"><span class="keyword">function</span> (<span class="params">flow</span>) </span>&#123;</span><br><span class="line">    A.hasGoodMood(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    A.receiveFlower(flow)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> A = &#123;</span><br><span class="line">receiveFlower: <span class="function"><span class="keyword">function</span> (<span class="params">flow</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;get flower&#x27;</span> + flow)</span><br><span class="line">&#125;,</span><br><span class="line">hasGoodMood: <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    fn()</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">M.sendFlower(B)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="保护代理和虚拟代理"><a href="#保护代理和虚拟代理" class="headerlink" title="保护代理和虚拟代理"></a>保护代理和虚拟代理</h2><blockquote>
<p>代理B可以帮助A过滤掉一些请求的叫做保护代理 (通过B来控制对A的访问)<br>代理 B 会选择在 A 心情好时再执行 new Flower叫作虚拟代理。 (虚拟代理把一些开销很大的对象，延迟到真正需要它的时候才去创建)  </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">        <span class="keyword">var</span> B = &#123;</span><br><span class="line">            receiveFlower: <span class="function"><span class="keyword">function</span>(<span class="params">flower</span>)</span>&#123;</span><br><span class="line">                A.listenGoodMood(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;    <span class="comment">//监听A的好心情</span></span><br><span class="line">                    <span class="keyword">var</span> flower = <span class="keyword">new</span> Flower() <span class="comment">//延迟创建flower对象</span></span><br><span class="line">                    A.receiveFlower(flower)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string">## 虚拟代理实现图片预加载</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>javascript</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> oImg = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> imgNode = <span class="built_in">document</span>.createElement(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line">            <span class="built_in">document</span>.body.appendChild(imgNode)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                setSrc : <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">                    imgNode.src = src</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)()</span><br><span class="line"></span><br><span class="line">        <span class="comment">//代理对象</span></span><br><span class="line">        <span class="keyword">var</span> proxyImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> img = <span class="keyword">new</span> Image()   <span class="comment">//获取的img对象</span></span><br><span class="line">            img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                oImg.setSrc(<span class="built_in">this</span>.src)   <span class="comment">//img.src</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                setSrc: <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">                    oImg.setSrc(<span class="string">&#x27;./loading.gif&#x27;</span>)</span><br><span class="line">                    img.src = src</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)()</span><br><span class="line">        proxyImage.setSrc(<span class="string">&#x27;http://....jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="代理的意义"><a href="#代理的意义" class="headerlink" title="代理的意义"></a>代理的意义</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不使用代理的方式</span></span><br><span class="line"><span class="keyword">var</span> oImg = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> imgNode = <span class="built_in">document</span>.createElement(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(imgNode)</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        imgNode.src = img.src</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        setSrc : <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">            imgNode.src = <span class="string">&#x27;./timg.jpg&#x27;</span></span><br><span class="line">            img.src = src</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line">oImg.setSrc(<span class="string">&#x27;https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=629448732,2965351611&amp;fm=15&amp;gp=0.jpg&#x27;</span>)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p>单一职责原则：为了减少代码的耦合性，方便维护和修改</p>
<h2 id="代理和本体接口的一致性"><a href="#代理和本体接口的一致性" class="headerlink" title="代理和本体接口的一致性"></a>代理和本体接口的一致性</h2><blockquote>
<p>调用时的代理接口和本地接口名称一致 也通过直接返回函数  </p>
</blockquote>
<p><b style='color:red'>优点：</b></p>
<ol>
<li>用户可以放心地请求代理，他只关心是否能得到想要的结构</li>
<li>在任何使用本体的地方都可以替换成使用代理<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> imgNode = <span class="built_in">document</span>.createElement(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line">    <span class="built_in">document</span>.appendChild(imgNode)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">        imgNode.src = src</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxyImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        myImage( <span class="built_in">this</span>.src )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">        myImage(<span class="string">&#x27;./timg.jpg&#x27;</span>)</span><br><span class="line">        img.src = src</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line">proxyImage(<span class="string">&#x27;https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=629448732,2965351611&amp;fm=15&amp;gp=0.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-第五章__策略模式"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/12/28/%E7%AC%AC%E4%BA%94%E7%AB%A0__%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"
    >【第五章】策略模式</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/12/28/%E7%AC%AC%E4%BA%94%E7%AB%A0__%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time datetime="2019-12-28T02:21:42.000Z" itemprop="datePublished">2019-12-28</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h2><p>比如要实现某一个功能有多种方案可以选择。比如压缩文件的程序，既可以选择zip算法，也可以选择gzip算法</p>
<blockquote>
<p>定义： 定义一系列的算法，把它们一个个封装起来，并且使它们可以相互替换</p>
</blockquote>
<ul>
<li><p>策略模式的优缺点<br>  <b style='color:Red'>优点：</b></p>
<pre><code>  1. 策略模式利用组合、委托和多态等技术和思想，可以有效地避免多重条件选择语句。
  2. 策略模式提供了对开放—封闭原则的完美支持，将算法封装在独立的 strategy 中，使得它们易于切换，易于理解，易于扩展。
  3. 策略模式中的算法也可以复用在系统的其他地方，从而避免许多重复的复制粘贴工作。
  4. 在策略模式中利用组合和委托来让 Context 拥有执行算法的能力，这也是继承的一种更轻便的替代方案。</code></pre>
<p>  <b style='color:Red'>缺点：</b></p>
<pre><code>  1. 使用策略模式会在程序中增加许多策略类或者策略对象，但实际上这比把它们负责的逻辑堆砌在 Context 中要好
  2. 要使用策略模式，必须了解所有的 strategy，必须了解各个 strategy 之间的不同点，这样才能选择一个合适的 strategy。</code></pre>
<ul>
<li><p>使用策略模式计算奖金</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">绩效为 S 的人年终奖有 4 倍工资，绩效为 A 的人年终奖有 3 倍工资，而绩效为 B 的人年终奖是 2 倍工资。假设财务部要求我们提供一段代码，来方便他们计算员工的年终奖</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//最初代码实现</span></span><br><span class="line"><span class="keyword">var</span> calculateBonus = <span class="function"><span class="keyword">function</span>(<span class="params">performanceLevel,salary</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(performanceLevel === <span class="string">&#x27;S&#x27;</span>)<span class="keyword">return</span> salary*<span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span>(performanceLevel === <span class="string">&#x27;A&#x27;</span>)<span class="keyword">return</span> salary*<span class="number">3</span></span><br><span class="line">    <span class="keyword">if</span>(performanceLevel === <span class="string">&#x27;B&#x27;</span>)<span class="keyword">return</span> salary*<span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line">caculateBonus(<span class="string">&#x27;B&#x27;</span>,<span class="number">2000</span>) <span class="comment">//输出 4000</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">缺点：</span></span><br><span class="line"><span class="comment">1. calculateBonus 函数比较庞大，包含了很多 if-else 语句，这些语句需要覆盖所有的逻辑分支。</span></span><br><span class="line"><span class="comment">2. calculateBonus 函数缺乏弹性，如果增加了一种新的绩效等级 C，或者想把绩效 S 的奖金系数改为 5，那我们必须深入 calculateBonus 函数的内部实现，这是违反开放-封闭原则的。</span></span><br><span class="line"><span class="comment">3. 算法的复用性差，如果在程序的其他地方需要重用这些计算奖金的算法呢？我们的选择只有复制和粘贴。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用策略模式重构代码</span></span><br><span class="line"><span class="comment">//目的： 算法的使用与算法的实现分离</span></span><br><span class="line"><span class="keyword">var</span> perfromanceS = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">perfromanceS.prototype.calculate = <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary*<span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> perfromanceA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">perfromanceA.prototype.calculate = <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary*<span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> perfromanceB = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">perfromanceB.prototype.calculate = <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary*<span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//奖金类</span></span><br><span class="line"><span class="keyword">var</span> Bonus = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.salary = <span class="literal">null</span>      <span class="comment">//原始工资</span></span><br><span class="line">    <span class="built_in">this</span>.strategy = <span class="literal">null</span>       <span class="comment">//绩效等级对应的策略对象</span></span><br><span class="line">&#125;</span><br><span class="line">Bonus.prototype.setSalary = <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.salary = salary    <span class="comment">//设置员工的原始工资</span></span><br><span class="line">&#125;</span><br><span class="line">Bonus.prototype.setStrategy = <span class="function"><span class="keyword">function</span>(<span class="params">strategy</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.strategy = strategy</span><br><span class="line">&#125;</span><br><span class="line">Bonus.prototype.getBonus = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.strategy.calculate(<span class="built_in">this</span>.salary)     <span class="comment">//把计算奖金的操作委托给对应的策略对象</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bonus = <span class="keyword">new</span> Bonus(); </span><br><span class="line">bonus.setSalary( <span class="number">10000</span> ); </span><br><span class="line">bonus.setStrategy( <span class="keyword">new</span> performanceS() ); <span class="comment">// 设置策略对象</span></span><br><span class="line"><span class="built_in">console</span>.log( bonus.getBonus() ); <span class="comment">// 输出：40000 </span></span><br><span class="line">bonus.setStrategy( <span class="keyword">new</span> performanceA() ); <span class="comment">// 设置策略对象</span></span><br><span class="line"><span class="built_in">console</span>.log( bonus.getBonus() ); <span class="comment">// 输出：30000</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>JavaScript版本的策略模式</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">我们让 strategy 对象从各个策略类中创建而来，这是模拟一些传统面向对象语言的实现。实际上在 JavaScript 语言中，函数也是对象，所以更简单和直接的做法是把 strategy直接定义为函数：</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//策略对象</span></span><br><span class="line"><span class="keyword">var</span> strategies = &#123;</span><br><span class="line">    <span class="string">&quot;S&quot;</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salary*<span class="number">4</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;A&quot;</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salary*<span class="number">3</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;B&quot;</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> salary </span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salary*<span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//操作类</span></span><br><span class="line"><span class="keyword">var</span> calculateBonus = <span class="function"><span class="keyword">function</span>(<span class="params">level,salary</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> strategies[level](salary)</span><br><span class="line">&#125;</span><br><span class="line">calculateBonus(<span class="string">&#x27;S&#x27;</span>,<span class="number">200</span>)  <span class="comment">//800</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2019-2020
        <i class="ri-heart-fill heart_icon"></i> John Doe
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="https://i.bmp.ovh/imgs/2020/04/9093acc7c93b3786.png" alt="Doreen&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->


<script src="/js/clickBoom2.js"></script>


<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
  </div>
</body>

</html>